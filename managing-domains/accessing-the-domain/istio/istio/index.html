<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.153.0">
    <meta name="generator" content="Relearn 8.3.0">
    <meta name="description" content="Run the operator and WebLogic domains managed by the operator when Istio sidecar injection is enabled.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Istio support :: WebLogic Kubernetes Operator">
    <meta name="twitter:description" content="Run the operator and WebLogic domains managed by the operator when Istio sidecar injection is enabled.">
    <meta property="og:url" content="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/istio/istio/index.html">
    <meta property="og:site_name" content="WebLogic Kubernetes Operator">
    <meta property="og:title" content="Istio support :: WebLogic Kubernetes Operator">
    <meta property="og:description" content="Run the operator and WebLogic domains managed by the operator when Istio sidecar injection is enabled.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Manage domains">
    <meta property="article:published_time" content="2019-08-15T13:30:04-04:00">
    <meta property="article:modified_time" content="2019-08-15T13:30:04-04:00">
    <meta itemprop="name" content="Istio support :: WebLogic Kubernetes Operator">
    <meta itemprop="description" content="Run the operator and WebLogic domains managed by the operator when Istio sidecar injection is enabled.">
    <meta itemprop="datePublished" content="2019-08-15T13:30:04-04:00">
    <meta itemprop="dateModified" content="2019-08-15T13:30:04-04:00">
    <meta itemprop="wordCount" content="2166">
    <title>Istio support :: WebLogic Kubernetes Operator</title>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/images/logo.png?1771473832" rel="icon" type="image/png">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/auto-complete/auto-complete.min.css?1771473832" rel="stylesheet">
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/auto-complete/auto-complete.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search-lunr.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search.min.js?1771473832" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="https://oracle.github.io/weblogic-kubernetes-operator/searchindex.en.js?1771473832";
    </script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.stemmer.support.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.multi.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.en.min.js?1771473832" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1771473832" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1771473832" rel="stylesheet"></noscript>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/perfect-scrollbar/perfect-scrollbar.min.css?1771473832" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/theme.min.css?1771473832" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/format-html.min.css?1771473832" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/managing-domains\/accessing-the-domain\/istio\/istio\/index.html';
      window.relearn.relBasePath='..\/..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/oracle.github.io\/weblogic-kubernetes-operator';
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'learn' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/istio/istio/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#limitations">Limitations</a></li>
    <li><a href="#determining-the-istio-version">Determining the Istio version</a></li>
    <li><a href="#setting-up-an-operator-with-istio-support">Setting up an operator with Istio support</a></li>
    <li><a href="#creating-a-domain-with-istio-support">Creating a domain with Istio support</a>
      <ul>
        <li>
          <ul>
            <li><a href="#configuring-the-domain-resource">Configuring the domain resource</a></li>
          </ul>
        </li>
        <li><a href="#applying-a-domain-yaml-file">Applying a Domain YAML file</a></li>
        <li><a href="#exposing-applications-in-istio-enabled-domains">Exposing applications in Istio-enabled domains</a></li>
      </ul>
    </li>
    <li><a href="#traffic-management">Traffic management</a></li>
    <li><a href="#distributed-tracing">Distributed tracing</a></li>
    <li><a href="#automatically-added-network-channels">Automatically added network channels</a>
      <ul>
        <li><a href="#network-channel-for-istio-versions-v110-and-later">Network channel for Istio versions v1.10 and later</a></li>
        <li><a href="#network-channel-for-weblogic-ejb-and-servlet-session-state-replication-traffic">Network channel for WebLogic EJB and servlet session state replication traffic</a></li>
      </ul>
    </li>
    <li><a href="#security">Security</a>
      <ul>
        <li><a href="#mutual-tls">Mutual TLS</a></li>
        <li><a href="#authorization-policy">Authorization policy</a></li>
        <li><a href="#destination-rule">Destination rule</a></li>
        <li><a href="#ingress-gateway">Ingress gateway</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><span itemprop="name">WebLogic Kubernetes Operator</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><span itemprop="name">Manage domains</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><span itemprop="name">Access and monitor domains</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Istio support</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/oci-lb/index.html" title="Use an OCI load balancer (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/external-clients/index.html" title="External WebLogic clients (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable managing-domains" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>



<h1 id="istio-support">Istio support</h1>



<h3 id="contents">Contents</h3>
<div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#limitations">Limitations</a></li>
    <li><a href="#determining-the-istio-version">Determining the Istio version</a></li>
    <li><a href="#setting-up-an-operator-with-istio-support">Setting up an operator with Istio support</a></li>
    <li><a href="#creating-a-domain-with-istio-support">Creating a domain with Istio support</a>
      <ul>
        <li>
          <ul>
            <li><a href="#configuring-the-domain-resource">Configuring the domain resource</a></li>
          </ul>
        </li>
        <li><a href="#applying-a-domain-yaml-file">Applying a Domain YAML file</a></li>
        <li><a href="#exposing-applications-in-istio-enabled-domains">Exposing applications in Istio-enabled domains</a></li>
      </ul>
    </li>
    <li><a href="#traffic-management">Traffic management</a></li>
    <li><a href="#distributed-tracing">Distributed tracing</a></li>
    <li><a href="#automatically-added-network-channels">Automatically added network channels</a>
      <ul>
        <li><a href="#network-channel-for-istio-versions-v110-and-later">Network channel for Istio versions v1.10 and later</a></li>
        <li><a href="#network-channel-for-weblogic-ejb-and-servlet-session-state-replication-traffic">Network channel for WebLogic EJB and servlet session state replication traffic</a></li>
      </ul>
    </li>
    <li><a href="#security">Security</a>
      <ul>
        <li><a href="#mutual-tls">Mutual TLS</a></li>
        <li><a href="#authorization-policy">Authorization policy</a></li>
        <li><a href="#destination-rule">Destination rule</a></li>
        <li><a href="#ingress-gateway">Ingress gateway</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
<h3 id="overview">Overview<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>

<details open class="box cstyle notices note">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-circle"></i> 
    Note
  </summary>
  <div class="box-content">
<p>These instructions assume that you are using a Kubernetes cluster with


<a href="https://istio.io/latest/docs/setup/install/"
   
   
target="_blank" rel="noopener noreferrer"
>
Istio
</a>
 installed and configured already.  The operator will not install
Istio for you.</p>
  </div>
</details>
<p>Istio support lets you run the operator, and WebLogic domains managed by
the operator, when Istio sidecar injection is enabled. You can use
Istio gateways and virtual services to access applications deployed in these domains.
If your applications have suitable tracing code in them, then you will also be able to
use distributed tracing, such as Jaeger, to trace requests across domains and to
other components and services that have tracing enabled.</p>
<p>WebLogic Kubernetes Operator assumes that you are familiar with Istio. If you are new to
Istio, we strongly recommend reading the documentation and working through the <code>Bookinfo</code>
sample application to familiarize yourself with the mesh and verify that it is working properly in your environment, before proceeding to work with the operator.</p>
<p>To learn more about Istio,
see 

<a href="https://istio.io/latest/docs/concepts/what-is-istio/"
   
   
target="_blank" rel="noopener noreferrer"
>
What is Istio
</a>
.</p>
<h3 id="limitations">Limitations<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>The current support for Istio has these limitations:</p>
<ul>
<li>
<p>The operator supports Istio versions 1.10 and later,
and has been tested with single and multicluster
Istio installations from 1.10 up to 1.13.2.</p>
</li>
<li>
<p>When using Istio in Red Hat OpenShift, operator version 4.0 and later is compatible only with Red Hat OpenShift version 4.11.x with the latest Service Mesh 2.2.3 and later.</p>
</li>
<li>
<p>You cannot set up a NodePort using <code>domain.spec.adminServer.adminService.channels</code>
with a <code>channelName</code> of <code>default</code>, <code>default-secure</code>, and <code>default-admin</code>.
Any attempt will result in an error when deploying a domain
in combination with Istio.</p>
</li>
<li>
<p>If the <code>istio-ingressgateway</code> service in your environment
does not have an <code>EXTERNAL-IP</code> defined and
you would like to externally run WLST commands,
then see


<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/wlst/"
   
   >
Use WLST
</a>
.</p>
</li>
</ul>
<h3 id="determining-the-istio-version">Determining the Istio version<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>To see the Istio build version that is installed, use the <code>istioctl version</code> command.  For example:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ istioctl version
</span></span><span style="display:flex;"><span>client version: 1.11.1
</span></span><span style="display:flex;"><span>control plane version: 1.11.1
</span></span><span style="display:flex;"><span>data plane version: 1.11.1 <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> proxies<span style="color:#f92672">)</span></span></span></code></pre></div>
<h3 id="setting-up-an-operator-with-istio-support">Setting up an operator with Istio support<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Istio support requires labeling the operator namespace and
your domain namespaces to enable Istio automatic
sidecar injection. In this section, we describe
the steps for the operator namespace; we will describe
the steps for the domain in later sections.</p>
<p>Before installing the operator,
create the namespace in which you want to run the operator and label it.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl create namespace weblogic-operator</span></span></code></pre></div>
<p>Label the namespace as follows:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl label namespace weblogic-operator istio-injection<span style="color:#f92672">=</span>enabled</span></span></code></pre></div>
<p>After the namespace is labeled, you can 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/installation/"
   
   >
install the operator
</a>
.</p>
<p>When the operator pod starts, you will notice that Istio automatically injects an <code>initContainer</code> called <code>istio-init</code>
and the Envoy container <code>istio-proxy</code>.</p>
<p>You can validate this using the following commands:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl --namespace weblogic-operator get pods</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl --namespace weblogic-operator get pod weblogic-operator-xxx-xxx -o yaml</span></span></code></pre></div>
<p>In the second command, change <code>weblogic-operator-xxx-xxx</code> to the name of your pod.</p>
<h3 id="creating-a-domain-with-istio-support">Creating a domain with Istio support<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Setting up Istio support for a domain requires only enabling Istio automatic sidecar injection.</p>
<p>To allow your domains to run with Istio automatic sidecar injection enabled,
create the namespace in which you want to run the domain
and label it for automatic injection before deploying your domain.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl create namespace sample-domain1</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl label namespace sample-domain1 istio-injection<span style="color:#f92672">=</span>enabled</span></span></code></pre></div>
<h5 id="configuring-the-domain-resource">Configuring the domain resource<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h5>
<p>Beginning with WebLogic Kubernetes Operator release 4.0, you no longer have to provide the <code>domain.spec.configuration.istio</code> section to
enable Istio support for a domain.  The <code>domain.spec.configuration.istio</code> is no longer a valid field in the schema.</p>
<h4 id="applying-a-domain-yaml-file">Applying a Domain YAML file<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Apply a Domain YAML file by:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl apply -f domain.yaml</span></span></code></pre></div>
<p>After all the servers are up, you will see output like this:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-domain1-ns get pods</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                             READY   STATUS    RESTARTS   AGE
sample-domain1-admin-server      2/2     Running   0          154m
sample-domain1-managed-server1   2/2     Running   0          153m
sample-domain1-managed-server2   2/2     Running   0          153m</code></pre></div>
<p>If you use <code>istioctl proxy-status</code>, you will see the mesh status:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ istioctl proxy-status</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>NAME                                                               CDS        LDS        EDS        RDS          PILOT                            VERSION
</span></span><span style="display:flex;"><span>istio-ingressgateway-5c7d8d7b5d-tjgtd.istio-system                 SYNCED     SYNCED     SYNCED     NOT SENT     istio-pilot-6cfcdb75dd-87lqm     1.5.4
</span></span><span style="display:flex;"><span>sample-domain1-admin-server.sample-domain1-ns                      SYNCED     SYNCED     SYNCED     SYNCED       istio-pilot-6cfcdb75dd-87lqm     1.5.4
</span></span><span style="display:flex;"><span>sample-domain1-managed-server1.sample-domain1-ns                   SYNCED     SYNCED     SYNCED     SYNCED       istio-pilot-6cfcdb75dd-87lqm     1.5.4
</span></span><span style="display:flex;"><span>sample-domain1-managed-server2.sample-domain1-ns                   SYNCED     SYNCED     SYNCED     SYNCED       istio-pilot-6cfcdb75dd-87lqm     1.5.4
</span></span><span style="display:flex;"><span>weblogic-operator-7d86fffbdd-5dxzt.weblogic-operator-ns     SYNCED     SYNCED     SYNCED     SYNCED       istio-pilot-6cfcdb75dd-87lqm     1.5.4</span></span></code></pre></div>
<h4 id="exposing-applications-in-istio-enabled-domains">Exposing applications in Istio-enabled domains<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>When a domain is running with Istio support, you should use the Istio ingress
gateway to provide external access to applications, instead of using an ingress
controller like Traefik.  Using the Istio ingress gateway, you can also view the
traffic in Kiali and use distributed tracing from the entry point to
the cluster.</p>
<p>To configure external access to your domain, you need to create an Istio <code>Gateway</code> and
<code>VirtualService</code>, as shown in the following example:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">networking.istio.io/v1alpha3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Gateway</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">domain1-gateway</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">sample-domain1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">istio</span>: <span style="color:#ae81ff">ingressgateway</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">servers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">hosts</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#e6db74">&#39;yourdomain.dns.com&#39;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">port</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">number</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">HTTP</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">networking.istio.io/v1alpha3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">VirtualService</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">domain1-virtualservice</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">sample-domain1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">gateways</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">domain1-gateway</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">hosts</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#39;yourdomain.dns.com&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">http</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">match</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">uri</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">prefix</span>: <span style="color:#ae81ff">/console</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">7001</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">route</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">destination</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">host</span>: <span style="color:#ae81ff">sample-domain1-admin-server.sample-domain1-ns.svc.cluster.local</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">port</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">number</span>: <span style="color:#ae81ff">7001</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">match</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">uri</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">prefix</span>: <span style="color:#ae81ff">/testwebapp</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8001</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">route</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">destination</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">host</span>: <span style="color:#ae81ff">sample-domain1-cluster-cluster-1.domain1.svc.cluster.local</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">port</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">number</span>: <span style="color:#ae81ff">8001</span></span></span></code></pre></div>
<p>This example creates a gateway that will accept requests with any host name
using HTTP on port 80, and a virtual service that will route all of
those requests to the cluster service for <code>cluster-1</code> in <code>domain1</code> in
the namespace <code>domain1</code>.  <strong>NOTE</strong>: In a production environment, <code>hosts</code> should be limited to the proper DNS name.</p>
<p>After the gateway and virtual service has been set up, you can access it through your ingress host and port.
Refer to 

<a href="https://istio.io/latest/docs/setup/getting-started/#determining-the-ingress-ip-and-ports"
   
   
target="_blank" rel="noopener noreferrer"
>
Determining the ingress IP and ports
</a>
.</p>
<p>For more information about providing ingress using Istio, see the 

<a href="https://istio.io/docs/tasks/traffic-management/ingress/"
   
   
target="_blank" rel="noopener noreferrer"
>
Istio documentation
</a>
.</p>
<h3 id="traffic-management">Traffic management<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Istio provides traffic management capabilities, including the ability to
visualize traffic in Kiali.  You do not need to change your applications to use
this feature.  The Istio proxy (Envoy) sidecar that is injected into your pods
provides it. The following image shows an example with traffic
flowing: in from the Istio gateway on the left, to a domain called <code>domain1</code>.</p>
<p>In this example, you can see how the traffic flows to the cluster services and
then to the individual Managed Servers.</p>
<img src="https://oracle.github.io/weblogic-kubernetes-operator/images/kiali.png" alt="Traffic visualization with Kiali">
<p>To learn more, see 

<a href="https://istio.io/docs/concepts/traffic-management/"
   
   
target="_blank" rel="noopener noreferrer"
>
Istio traffic management
</a>
.</p>
<h3 id="distributed-tracing">Distributed tracing<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Istio provides distributed tracing capabilities, including the ability to view
traces in Jaeger.  To use distributed tracing though, first you will need to
instrument your WebLogic application, for example, using the


<a href="https://github.com/jaegertracing/jaeger-client-java"
   
   
target="_blank" rel="noopener noreferrer"
>
Jaeger Java client
</a>
.
The following image shows an example of a distributed trace
that shows a transaction following the same path through the system
as shown in the previous image.</p>
<img src="https://oracle.github.io/weblogic-kubernetes-operator/images/jaeger.png" alt="Distributed tracing with Jaeger">
<p>To learn more, see 

<a href="https://istio.io/docs/tasks/telemetry/distributed-tracing/"
   
   
target="_blank" rel="noopener noreferrer"
>
distrubting tracing in Istio
</a>
.</p>
<h3 id="automatically-added-network-channels">Automatically added network channels<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>The operator will automatically
add network channels to each WebLogic Server
when Istio is enabled for a domain.</p>
<h4 id="network-channel-for-istio-versions-v110-and-later">Network channel for Istio versions v1.10 and later<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p><em>Background</em>:</p>
<p>Beginning with Istio version 1.10, Istio&rsquo;s networking behavior
was simplified. It changed
so that the Istio network proxy that runs in each Istio sidecar
(the Envoy proxy) no longer redirects
network traffic to the current pod&rsquo;s localhost interface,
but instead directly forwards it to the network interface associated
with the pod&rsquo;s IP address. This means that the operator
does not need to create additional localhost network
channels on each WebLogic pod except to enable
the readiness probe.</p>
<p>To learn more about changes to Istio networking beginning with Istio 1.10,
see 

<a href="https://istio.io/latest/blog/2021/upcoming-networking-changes/"
   
   
target="_blank" rel="noopener noreferrer"
>
Upcoming networking changes in Istio 1.10
</a>
.</p>
<p><em>Channel behavior</em>:</p>
<p>When deploying a domain that is configured to support Istio versions 1.10 and later,
the operator automatically adds an HTTP protocol network channel
(also known as Network Access Points) to your
WebLogic configuration for each server so that the pod&rsquo;s
readiness probe is bound to the server pod&rsquo;s network interface:</p>
<table>
  <thead>
      <tr>
          <th>Channel Name</th>
          <th>Port</th>
          <th>Listen address</th>
          <th>Protocol</th>
          <th>Exposed as a container port</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>http-probe-ext</code></td>
          <td>From configuration Istio <code>readinessPort</code></td>
          <td>Server Pod&rsquo;s IP address</td>
          <td><code>http</code></td>
          <td>No</td>
      </tr>
  </tbody>
</table>
<h4 id="network-channel-for-weblogic-ejb-and-servlet-session-state-replication-traffic">Network channel for WebLogic EJB and servlet session state replication traffic<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>WebLogic Kubernetes Operator versions 4.0 and later support WebLogic EJB and servlet session state replication traffic in
an Istio service mesh; it uses the default channel of the domain for replication.</p>
<h3 id="security">Security<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Istio provides rich sets of security features that you can use to secure the Istio service mesh environments.  For details, see Istio 

<a href="https://istio.io/latest/docs/concepts/security/"
   
   
target="_blank" rel="noopener noreferrer"
>
Security
</a>
.   The following are some sample scenarios.</p>
<h4 id="mutual-tls">Mutual TLS<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>By default, all traffic between the Istio sidecar proxies use mutual TLS within the mesh. However, service within the mesh can still be accessed by other pods outside the mesh.  For example, you have <code>domain-1</code>  deployed with sidecar injection, therefore within the mesh, and another domain, <code>domain-2</code>, deployed without sidecar injection, therefore outside of the mesh. Services within <code>domain-2</code> can still access the services within <code>domain-1</code>, however the traffic will be <code>Plain</code> unencrypted traffic.   This is because by default, Istio configures the traffic using the <code>PERMISSIVE</code> mode, which means it can accept both <code>Plain</code> and <code>mutual TLS</code> traffic.  You can restrict this behavior by allowing only <code>mutual TLS</code> traffic by locking down the entire mesh or by namespace within the mesh.</p>
<p>For locking down the entire mesh, you can:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>kubectl apply -n istio-system -f - &lt;&lt;EOF
</span></span><span style="display:flex;"><span>apiVersion: security.istio.io/v1beta1
</span></span><span style="display:flex;"><span>kind: PeerAuthentication
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: &#34;default&#34;
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  mtls:
</span></span><span style="display:flex;"><span>    mode: STRICT
</span></span><span style="display:flex;"><span>EOF</span></span></code></pre></div>
<p>For namespace only, you can:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>kubectl apply -n &lt;your namespace&gt; -f - &lt;&lt;EOF
</span></span><span style="display:flex;"><span>apiVersion: security.istio.io/v1beta1
</span></span><span style="display:flex;"><span>kind: PeerAuthentication
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: &#34;default&#34;
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  mtls:
</span></span><span style="display:flex;"><span>    mode: STRICT
</span></span><span style="display:flex;"><span>EOF</span></span></code></pre></div>
<p>See Istio 

<a href="https://istio.io/latest/docs/tasks/security/authentication/mtls-migration"
   
   
target="_blank" rel="noopener noreferrer"
>
Mutual TLS Migration
</a>
.</p>
<h4 id="authorization-policy">Authorization policy<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Istio provides policy-based authorization using <code>AuthorizationPolicy</code>.  You can set up policies to deny or allow access to services deployed in the mesh.  For example, if you want to limit access to a particular service in the domain from another namespace only with a service account.</p>
<p>Create a service account for the client namespace.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>kubectl -n domain2-ns create serviceaccount privaccess</span></span></code></pre></div>
<p>Set up the service account in the client deployment pod.  For example, if it is another <code>WebLogic Domain</code> in the <code>Operator</code>, specify the <code>ServiceAccountName</code> in the <code>domain.spec.serverPod</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  serverPod:
</span></span><span style="display:flex;"><span>     serviceAccountName:  privaccess</span></span></code></pre></div>
<p>Create an <code>AuthorizationPolicy</code> for the target service.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: privaccess
  namespace: sample-domain1-ns
spec:
  action: ALLOW
  rules:
  - from:
    - source:
        principals: [&#34;cluster.local/ns/domain2-ns/sa/privaccess&#34;]
    to:
    - operation:
        methods: [&#34;GET&#34;]
        paths: [&#34;/domain1-priv-service&#34;]</code></pre></div>
<p>See Istio 

<a href="https://istio.io/latest/docs/reference/config/security/authorization-policy/"
   
   
target="_blank" rel="noopener noreferrer"
>
Authorization Policy
</a>
.</p>
<h4 id="destination-rule">Destination rule<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Istio allows you to define traffic management polices applied to the service after the routing has occurred. You can use it to control load balancing, connection pool size from the sidecar, and outlier detection settings to detect and evict unhealthy hosts from the load balancing pool. You can also set up a service-level mutual TLS requirement instead of entire mesh or namespace-based.</p>
<p>For example, to configure service-level mutual TLS:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>apiVersion: networking.istio.io/v1alpha3
</span></span><span style="display:flex;"><span>kind: DestinationRule
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: sample-domain1-service
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  host: sample-domain1-cluster-cluster-1.sample-domain1-ns.svc.cluster.local
</span></span><span style="display:flex;"><span>  trafficPolicy:
</span></span><span style="display:flex;"><span>    tls:
</span></span><span style="display:flex;"><span>      mode: ISTIO_MUTUAL</span></span></code></pre></div>
<p>For example, to configure a sticky session for a service using hashing-based hash key <code>user_cookie</code>:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>apiVersion: networking.istio.io/v1alpha3
</span></span><span style="display:flex;"><span>kind: DestinationRule
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: sample-domain1-service
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  host: sample-domain1-cluster-cluster-1.sample-domain1-ns.svc.cluster.local
</span></span><span style="display:flex;"><span>  trafficPolicy:
</span></span><span style="display:flex;"><span>    loadBalancer:
</span></span><span style="display:flex;"><span>      consistentHash:
</span></span><span style="display:flex;"><span>        httpCookie:
</span></span><span style="display:flex;"><span>          name: user_cookie
</span></span><span style="display:flex;"><span>          ttl: 0s</span></span></code></pre></div>
<p>See Istio 

<a href="https://istio.io/latest/docs/reference/config/networking/destination-rule/"
   
   
target="_blank" rel="noopener noreferrer"
>
Destination Rule
</a>
.</p>
<h4 id="ingress-gateway">Ingress gateway<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Ingress gateway provides similar functions to <code>Kubernetes Ingress</code> but with more advanced functionality.</p>
<p>I. For example, to configure an Ingress gateway for SSL termination at the gateway:</p>
<ol>
<li>Create a TLS certificate and secret.</li>
</ol>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /tmp/tls1.key -out /tmp/tls1.crt -subj &#34;/CN=secure-domain.org&#34;
</span></span><span style="display:flex;"><span>$ kubectl -n istio-system create secret tls domain1-tls-cert --key /tmp/tls1.key --cert /tmp/tls1.crt</span></span></code></pre></div>
<ol start="2">
<li>Create the Ingress gateway.</li>
</ol>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>apiVersion: networking.istio.io/v1alpha3
</span></span><span style="display:flex;"><span>kind: Gateway
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: sample-domain1-gateway
</span></span><span style="display:flex;"><span>  namespace: sample-domain1-ns
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  selector:
</span></span><span style="display:flex;"><span>    istio: ingressgateway
</span></span><span style="display:flex;"><span>  servers:
</span></span><span style="display:flex;"><span>    - port:
</span></span><span style="display:flex;"><span>        number: 443
</span></span><span style="display:flex;"><span>        name: https
</span></span><span style="display:flex;"><span>        protocol: HTTPS
</span></span><span style="display:flex;"><span>      tls:
</span></span><span style="display:flex;"><span>        mode: SIMPLE
</span></span><span style="display:flex;"><span>        credentialName: domain1-tls-cert
</span></span><span style="display:flex;"><span>      hosts:
</span></span><span style="display:flex;"><span>      - &#39;secure-domain.org&#39;
</span></span><span style="display:flex;"><span>    - port:
</span></span><span style="display:flex;"><span>        number: 80
</span></span><span style="display:flex;"><span>        name: http
</span></span><span style="display:flex;"><span>        protocol: HTTP
</span></span><span style="display:flex;"><span>      hosts:
</span></span><span style="display:flex;"><span>      - &#39;regular-domain.org&#39;</span></span></code></pre></div>
<p>If you are accessing the WebLogic Console through a secure gateway with SSL termination at the gateway level, enable
<code>WeblogicPluginEnabled</code> in the WebLogic domain and add the appropriate request headers.  For example,</p>
<p>If you are using WDT, add the <code>resources</code> section in the model YAML file.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>      resources:
</span></span><span style="display:flex;"><span>         WebAppContainer:
</span></span><span style="display:flex;"><span>            WeblogicPluginEnabled: true</span></span></code></pre></div>
<p>If you are using WLST, set the <code>WeblogicPluginEnabled</code> for each server and cluster</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>   set(&#39;WeblogicPluginEnabled&#39;,true)</span></span></code></pre></div>
<p>Set the request headers in the virtual service:  (Use <code>kubectl explain virtualservice.spec.http.route.headers</code> for help)</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>   headers:
</span></span><span style="display:flex;"><span>     request:
</span></span><span style="display:flex;"><span>       remove: [&#39;WL-Proxy-Client-IP&#39;,  &#39;WL-Proxy-SSL&#39;]
</span></span><span style="display:flex;"><span>       set:
</span></span><span style="display:flex;"><span>         X-Forwarded-Proto: https
</span></span><span style="display:flex;"><span>         WL-Proxy-SSL: &#39;true&#39;</span></span></code></pre></div>
<p>II. For example, to configure an Ingress gateway for SSL passthrough:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>apiVersion: networking.istio.io/v1alpha3
</span></span><span style="display:flex;"><span>kind: Gateway
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: sample-domain1-gateway
</span></span><span style="display:flex;"><span>  namespace: sample-domain1-ns
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  selector:
</span></span><span style="display:flex;"><span>    istio: ingressgateway
</span></span><span style="display:flex;"><span>  servers:
</span></span><span style="display:flex;"><span>    - port:
</span></span><span style="display:flex;"><span>        number: 443
</span></span><span style="display:flex;"><span>        name: https
</span></span><span style="display:flex;"><span>        protocol: HTTPS
</span></span><span style="display:flex;"><span>      tls:
</span></span><span style="display:flex;"><span>        mode: PASSTHROUGH
</span></span><span style="display:flex;"><span>      hosts:
</span></span><span style="display:flex;"><span>      - &#39;secure-domain.org&#39;
</span></span><span style="display:flex;"><span>    - port:
</span></span><span style="display:flex;"><span>        number: 80
</span></span><span style="display:flex;"><span>        name: http
</span></span><span style="display:flex;"><span>        protocol: HTTP
</span></span><span style="display:flex;"><span>      hosts:
</span></span><span style="display:flex;"><span>      - &#39;regular-domain.org&#39;</span></span></code></pre></div>
<p>The virtual service will then configure to match the <code>tls</code> rule.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>apiVersion: networking.istio.io/v1alpha3
</span></span><span style="display:flex;"><span>kind: VirtualService
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: sample-domain1-virtualservice
</span></span><span style="display:flex;"><span>  namespace: sample-domain1-ns
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>  gateways:
</span></span><span style="display:flex;"><span>    - sample-domain1-gateway
</span></span><span style="display:flex;"><span>  hosts:
</span></span><span style="display:flex;"><span>    - secure-domain.org
</span></span><span style="display:flex;"><span>  tls:
</span></span><span style="display:flex;"><span>  - match:
</span></span><span style="display:flex;"><span>    - port: 443
</span></span><span style="display:flex;"><span>      sniHosts:
</span></span><span style="display:flex;"><span>      - secure-domain.org
</span></span><span style="display:flex;"><span>    route:
</span></span><span style="display:flex;"><span>    - destination:
</span></span><span style="display:flex;"><span>        host: sample-domain1-admin-server
</span></span><span style="display:flex;"><span>        port:
</span></span><span style="display:flex;"><span>          number: 9002    </span></span></code></pre></div>
<p>See Istio 

<a href="https://istio.io/latest/docs/tasks/traffic-management/ingress"
   
   
target="_blank" rel="noopener noreferrer"
>
Ingress
</a>
.</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">


<a id="logo" href="https://oracle.github.io/weblogic-kubernetes-operator/">
  <img src="https://oracle.github.io/weblogic-kubernetes-operator//images/logo.png" height="90"><br/>
  WebLogic Kubernetes Operator
</a>

        </div>
        <search><form action="https://oracle.github.io/weblogic-kubernetes-operator/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><b> </b>Quick Start</a><ul id="R-subsections-d63193e927818b6cb77d9c791ea48a61" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><b> </b>Introduction</a><ul id="R-subsections-e1ed3a04f1f57a27be4a8d0eb274be18" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><b> </b>Manage operators</a><ul id="R-subsections-7d4cf64999b86ce8197c0bc43769472c" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html">Manage domains</a><ul id="R-subsections-45a55625d0c34b621eb1935c75fae249" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html">About WebLogic domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html">Choose a domain home source type</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><b> </b>Domain and Cluster resources</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><b> </b>Upgrade Domain resource</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html">Prepare to run a domain</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><b> </b>Upgrade managed domains</a><ul id="R-subsections-ccbca7935ed481eeab6222c998578048" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><b> </b>Domain on Persistent Volume (PV)</a><ul id="R-subsections-d40ed8eea8326dbcd46326f7659b3e4f" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><b> </b>Model in Image</a><ul id="R-subsections-d9db9d9e38880e56d7ba5514a8527a97" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><b> </b>Configuration overrides</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><b> </b>Persistent storage</a><ul id="R-subsections-661be2f02fd0ae2ad3377779776a4545" class="collapsible-menu"></ul></li>
            <li class="parent alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><b> </b>Access and monitor domains</a><ul id="R-subsections-5f509e3b856bccb56052229a523c07b3" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/weblogic-admin-console/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/weblogic-admin-console/index.html">Use the Administration Console</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/remote-admin-console/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/remote-admin-console/index.html">Use the Remote Console</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/wlst/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/wlst/index.html">Use WLST</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/port-forward/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/port-forward/index.html">Use port forwarding</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/ingress/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/ingress/index.html">Ingress</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/oci-lb/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/oci-lb/index.html">Use an OCI load balancer</a></li>
            <li class="active " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/istio/istio/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/istio/istio/index.html">Istio support</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/external-clients/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/external-clients/index.html">External WebLogic clients</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/domain-events/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/domain-events/index.html">Domain events</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/status-conditions/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/status-conditions/index.html">Status conditions</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/logs/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/logs/index.html">Log files</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/monitoring-exporter/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/monitoring-exporter/index.html">Monitoring exporter</a></li></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><b> </b>Domain life cycle</a><ul id="R-subsections-47783ab45f0ad76897c1eb1a21f9e6e7" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html">CI/CD considerations</a><ul id="R-subsections-8802c993ce14e9bb7903113fc1be4858" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html">Manage FMW Infrastructure domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html">Azure Kubernetes Service (AKS)</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><b> </b>Domain debugging</a></li></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><b> </b>WebLogic images</a><ul id="R-subsections-b3440c9f2ce961fe2579290479f05e53" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><b> </b>Samples</a><ul id="R-subsections-88c2b1e6419b221ce89c4be4a8ae2a6b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><b> </b>Developer Guide</a><ul id="R-subsections-6d5a8d333894e1a8a4ced31c7a69170c" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><b> </b>Reference</a><ul id="R-subsections-66002f201bef818664bb81aa67490c58" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><b> </b>Security</a><ul id="R-subsections-66815ecaaecfc1c209e5637d03b258b2" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html">Frequently asked questions</a><ul id="R-subsections-24e4fc446616bf2bbeac7b1dba804bb8" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html">Deprecated functionality</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html">Known limitations</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer">

<p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp</p>
<p><a href="https://github.com/oracle/weblogic-kubernetes-operator"><i class="fab fa-github"></i> GitHub repo</a></p>
<p><a href="https://join.slack.com/t/oracle-weblogic/shared_invite/zt-1ni1gtjv6-PGC6CQ4uIte3KBdm_67~aQ"><i class="fab fa-slack"></i> Public Slack #weblogic</a></p>
</div>
      </div>
    </aside>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/perfect-scrollbar/perfect-scrollbar.min.js?1771473832" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/theme.min.js?1771473832" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
