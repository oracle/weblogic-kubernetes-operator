<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.153.0">
    <meta name="generator" content="Relearn 8.3.0">
    <meta name="description" content="Important information about using JRF domains.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="JRF domains :: WebLogic Kubernetes Operator">
    <meta name="twitter:description" content="Important information about using JRF domains.">
    <meta property="og:url" content="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html">
    <meta property="og:site_name" content="WebLogic Kubernetes Operator">
    <meta property="og:title" content="JRF domains :: WebLogic Kubernetes Operator">
    <meta property="og:description" content="Important information about using JRF domains.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Manage domains">
    <meta property="article:published_time" content="2023-04-26T16:45:16-05:00">
    <meta property="article:modified_time" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="name" content="JRF domains :: WebLogic Kubernetes Operator">
    <meta itemprop="description" content="Important information about using JRF domains.">
    <meta itemprop="datePublished" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="dateModified" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="wordCount" content="1529">
    <title>JRF domains :: WebLogic Kubernetes Operator</title>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/images/logo.png?1768967398" rel="icon" type="image/png">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/auto-complete/auto-complete.min.css?1768967398" rel="stylesheet">
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/auto-complete/auto-complete.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search-lunr.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search.min.js?1768967398" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="https://oracle.github.io/weblogic-kubernetes-operator/searchindex.en.js?1768967398";
    </script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.stemmer.support.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.multi.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.en.min.js?1768967398" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1768967398" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1768967398" rel="stylesheet"></noscript>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/perfect-scrollbar/perfect-scrollbar.min.css?1768967398" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/theme.min.css?1768967398" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/format-html.min.css?1768967398" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/managing-domains\/domain-on-pv\/jrf-domain\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/oracle.github.io\/weblogic-kubernetes-operator';
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'learn' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#sample-wdt-model-for-jrf-domain">Sample WDT model for JRF domain</a>
      <ul>
        <li><a href="#importance-of-domain-home-directory-backup">Importance of domain home directory backup</a></li>
        <li><a href="#download-opss-wallet-and-store-in-a-kubernetes-secret">Download OPSS wallet and store in a Kubernetes Secret</a></li>
        <li><a href="#disaster-recovery-for-domain-on-pv-deployment">Disaster recovery for Domain on PV deployment</a></li>
        <li><a href="#disaster-recovery-for-model-in-image-domains">Disaster recovery for Model in Image domains</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><span itemprop="name">WebLogic Kubernetes Operator</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><span itemprop="name">Manage domains</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><span itemprop="name">Domain on Persistent Volume (PV)</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">JRF domains</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/model-files/index.html" title="Working with WDT model files (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html" title="Model in Image (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable managing-domains" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>



<h1 id="jrf-domains">JRF domains</h1>



<h3 id="contents">Contents</h3>
<div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#sample-wdt-model-for-jrf-domain">Sample WDT model for JRF domain</a>
      <ul>
        <li><a href="#importance-of-domain-home-directory-backup">Importance of domain home directory backup</a></li>
        <li><a href="#download-opss-wallet-and-store-in-a-kubernetes-secret">Download OPSS wallet and store in a Kubernetes Secret</a></li>
        <li><a href="#disaster-recovery-for-domain-on-pv-deployment">Disaster recovery for Domain on PV deployment</a></li>
        <li><a href="#disaster-recovery-for-model-in-image-domains">Disaster recovery for Model in Image domains</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
<h3 id="overview">Overview<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>A Java Required Files (JRF) domain consists of those components not included in a WebLogic Server
installation that provide common functionality for Oracle business applications and application
frameworks. They consist of a number of independently developed libraries and applications that are
deployed in a common location.</p>
<p>Typically, a JRF domain is used by Fusion Middleware products. The JRF domain has database requirements.
The database components are created using Repository Creation Utility (RCU); a new RCU schema is created before creating a
JRF-based domain.</p>
<h3 id="sample-wdt-model-for-jrf-domain">Sample WDT model for JRF domain<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>For the operator to create a JRF domain, your WDT model must have a <code>RCUDbInfo</code> section in <code>domainInfo</code>.  This is a sample model
snippet of a typical JRF domain</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">domainInfo</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">RCUDbInfo</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">rcu_prefix</span>: <span style="color:#e6db74">&#39;@@SECRET:@@ENV:DOMAIN_UID@@-rcu-access:rcu_prefix@@&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">rcu_schema_password</span>: <span style="color:#e6db74">&#39;@@SECRET:@@ENV:DOMAIN_UID@@-rcu-access:rcu_schema_password@@&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">rcu_db_conn_string</span>: <span style="color:#e6db74">&#39;@@SECRET:@@ENV:DOMAIN_UID@@-rcu-access:rcu_db_conn_string@@&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># DBA credentials: required if operator is running the rcu in Domain On PV</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">rcu_db_user</span>: <span style="color:#e6db74">&#39;@@SECRET:@@ENV:DOMAIN_UID@@-rcu-access:dba_user@@&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">rcu_admin_password</span>: <span style="color:#e6db74">&#39;@@SECRET:@@ENV:DOMAIN_UID@@-rcu-access:dba_password@@&#39;</span></span></span></code></pre></div>
<p>Refer to 

<a href="https://oracle.github.io/weblogic-deploy-tooling/userguide/database/connect-db/"
   
   
target="_blank" rel="noopener noreferrer"
>
WebLogic Deploy Tooling Connect to a database
</a>
 for more information.</p>
<h4 id="importance-of-domain-home-directory-backup">Importance of domain home directory backup<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>A JRF domain has a one-to-one relationship with the RCU schema.  After a domain is created using a particular RCU schema,
that schema <em>cannot</em> be reused by another domain and the same schema <em>cannot</em> be shared across different domains.  Any attempts to
create a new domain using the schema that had already been used, will result in an error.</p>

<details open class="box cstyle notices warning">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-triangle"></i> 
    Warning
  </summary>
  <div class="box-content">
<p>If the domain home is not properly backed up, you potentially can lose existing data if the domain home is corrupted or deleted.
That&rsquo;s because recreating the domain requires dropping the existing RCU schema and creating a new RCU schema. Therefore, backing up the existing domain home should be
the highest priority in your Kubernetes environment.</p>
  </div>
</details>
<p>This is especially important for a Domain on PV deployment, where the domain is continually
updated after its initial deployment.  For example, you already deployed new applications, added custom OPSS keystores, added OWSM policies, and such.
The original models used to create the domain will not match the existing state of the domain (the models are not the source of truth)
and, if you use the original models to create the domain again, then you will lose all the updates that you have made. In order to preserve the domain updates, you should restore the domain from a backup copy of the domain home directory and connect to the existing RCU schema from the database backup.</p>
<h4 id="download-opss-wallet-and-store-in-a-kubernetes-secret">Download OPSS wallet and store in a Kubernetes Secret<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>After the domain is created, the operator will automatically export the OPSS wallet and
store it in an introspector ConfigMap; the name of the ConfigMap follows the pattern <code>&lt;domain uid&gt;-weblogic-domain-introspect-cm</code>
with the key <code>ewallet.p12</code>.  Export this file and put it in a safe place. The operator provides a


<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/kubernetes/samples/scripts/domain-lifecycle/opss-wallet.sh"
   
   
target="_blank" rel="noopener noreferrer"
>
OPSS wallet utility
</a>

for extracting this file and storing it in a Kubernetes <code>walletFileSecret</code>.  You should also save the wallet file in a safely backed-up location, outside of Kubernetes.</p>
<p>For example,</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ opss-wallet.sh -n sample-ns -d sample-domain1 -s -r -wf /tmp/ewallet.p12 -ws jrf-wallet-file-secret</code></pre></div>
<h4 id="disaster-recovery-for-domain-on-pv-deployment">Disaster recovery for Domain on PV deployment<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>When a JRF domain is created, an OPSS wallet is stored in the file system where the domain home resides.
This specific wallet key can be exported and used to create a new domain. There is no way to reuse the original RCU schema without this specific wallet key.
Therefore, for disaster recovery, <strong>you should back up this OPSS wallet</strong>.</p>
<p>After the operator creates the JRF domain, it stores the OPSS wallet in a ConfigMap. See 

<a href="#download-opss-wallet-and-store-in-a-kubernetes-secret"
   
   >
Download and save the OPSS wallet
</a>
.</p>
<p>Oracle recommends that you save the OPSS wallet file in a safe, backed-up location <strong>immediately</strong> after an initial JRF domain is created. In addition, you should make sure to store the wallet in a Kubernetes Secret in the same namespace. This will allow the secret to be available when the domain needs to be recovered in a disaster scenario or if the domain directory gets corrupted.</p>
<p>In the domain resource YAML file, you can provide two secrets in the <code>opss</code> section under <code>configuration.initializeDomainOnPV.domain</code>:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>     ...
     #  For domain on PV, opss settings are under `configuration.initializeDomainOnPV.domain.opss`
     #  DO NOT specify it under `configuration`
     #
     configuration:
        initializeDomainOnPV:
        ...
           domain:
              createIfNotExists: Domain
              domainType: JRF
              ...
              opss:
               walletFileSecret: jrf-wallet-file-secret
               walletPasswordSecret: sample-domain1-opss-wallet-password-secret</code></pre></div>
<p><code>walletPasswordSecret</code> is required during initial deployment.  This secret contains the password used to
encrypt the exported OPSS wallet.  You can create a Kubernetes Secret with the key <code>walletPassword</code> containing the password.
The password must have a minimum length of eight characters and contain alphabetic characters combined with numbers or special characters.</p>
<p>If the domain home directory is corrupted, and you have a recent backup of the domain home directory, then perform the following steps to recover the domain.</p>
<ol>
<li>
<p>Restore the domain home directory from the backup copy.</p>
</li>
<li>
<p>Update the <code>restartVersion</code> of the domain resource to restart the domain. For example,</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/restartVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>After the domain is restarted, check the WebLogic domain configuration to ensure that it has the latest changes.
<strong>NOTE</strong>: If you made any changes that are persisted in the domain home directory after your last backup, you must reapply those changes to the domain home directory.
However, because the operator will reconnect to the same RCU schema, the data stored in the OPSS, MDS, or OWSM tables will be current.</p>
</li>
<li>
<p>Reapply any domain configuration changes persisted to the domain home directory, such as
data source connections, JMS destinations, or new application EAR deployments, after your last backup. To make these changes, use WLST, the WebLogic Server Administration Console, or Enterprise Manager.</p>
</li>
</ol>
<p>In the rare scenario where the domain home directory is corrupted, and you do <strong>not</strong> have a recent backup of the domain home directory, or if the backup copy is also corrupted, then you can recreate the domain from the WDT model files without losing any RCU schema data.</p>
<ol>
<li>
<p>Delete the existing domain home directory on PV.</p>
</li>
<li>
<p>Specify the <code>walletFileSecret</code> - A Kubernetes Secret with the key <code>walletFile</code> containing the exported OPSS wallet
file <code>ewallet.p12</code> you created earlier.</p>
<p>For example,</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;add&#34;, &#34;path&#34; : &#34;/spec/configuration/initializeDomainOnPV/domain/opss/walletFileSecret&#34;, &#34;value&#34; : &#34;jrf-wallet-file-secret&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>Update the <code>introspectVersion</code> in the domain resource.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/intropsectVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>The operator will then create a new domain from the existing WDT models and reuse the original RCU schema.</p>
<p><strong>NOTE</strong>:
All the updates made to the domain after the initial deployment will <strong>not</strong> be available in the recovered domain.
However, this allows you to access the original RCU schema database without losing all its data.</p>
</li>
<li>
<p>Apply all the domain configuration changes persisted to the domain home file system, such as data source connections, JMS destinations, or new application EAR deployments, that are not in the WDT model files. These are the changes you have made <em>after</em> the initial domain deployment.</p>
</li>
<li>
<p>Update the <code>restartVersion</code> of the domain resource to restart the domain.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/restartVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
</ol>
<h4 id="disaster-recovery-for-model-in-image-domains">Disaster recovery for Model in Image domains<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p><strong>NOTE</strong>: JRF support in Model in Image domains has been deprecated since operator version 4.1.0; use the Domain on PV 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/"
   
   >
domain home source type
</a>
 instead.</p>
<p>When a JRF domain is created, an OPSS wallet is stored in the file system where the domain home resides.
This specific wallet key can be exported and used to create a new domain. There is no way to reuse the original RCU schema without this specific wallet key.
Therefore, for disaster recovery, <strong>you should back up this OPSS wallet</strong>.</p>
<p>After the operator creates the JRF domain, it stores the OPSS wallet in a ConfigMap. See 

<a href="#download-opss-wallet-and-store-in-a-kubernetes-secret"
   
   >
Download and save the OPSS wallet
</a>
.</p>
<p>In the domain resource YAML file, you can provide two secrets in the <code>opss</code> section under <code>configuration</code>:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>     configuration:
        model:
           ...
        opss:
           walletFileSecret: jrf-wallet-file-secret
           walletPasswordSecret: sample-domain1-opss-wallet-password-secret</code></pre></div>
<p><code>walletPasswordSecret</code> is required during initial deployment.  This secret contains the password used to
encrypt the exported OPSS wallet.  You can create a Kubernetes Secret with the key <code>walletPassword</code> containing the password.
The password must have a minimum length of eight characters and contain alphabetic characters combined with numbers or special characters.</p>
<p>In case the domain home directory is corrupted and you need to recreate the domain, and reuse the existing RCU schema:</p>
<ol>
<li>
<p>Specify the <code>walletFileSecret</code> - A Kubernetes Secret with the key <code>walletFile</code> containing the exported OPSS wallet
file <code>ewallet.p12</code> that you have created earlier.</p>
<p>For example,</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>  $ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;add&#34;, &#34;path&#34; : &#34;/spec/configuration/initializeDomainOnPV/domain/opss/walletFileSecret&#34;, &#34;value&#34; : &#34;jrf-wallet-file-secret&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>Update the <code>introspectVersion</code> in the domain resource.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/intropsectVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
</ol>
<p>The operator will create a new domain from the existing WDT models and reuse the original RCU schema.</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">


<a id="logo" href="https://oracle.github.io/weblogic-kubernetes-operator/">
  <img src="https://oracle.github.io/weblogic-kubernetes-operator//images/logo.png" height="90"><br/>
  WebLogic Kubernetes Operator
</a>

        </div>
        <search><form action="https://oracle.github.io/weblogic-kubernetes-operator/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><b> </b>Quick Start</a><ul id="R-subsections-d63193e927818b6cb77d9c791ea48a61" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><b> </b>Introduction</a><ul id="R-subsections-e1ed3a04f1f57a27be4a8d0eb274be18" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><b> </b>Manage operators</a><ul id="R-subsections-7d4cf64999b86ce8197c0bc43769472c" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html">Manage domains</a><ul id="R-subsections-45a55625d0c34b621eb1935c75fae249" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html">About WebLogic domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html">Choose a domain home source type</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><b> </b>Domain and Cluster resources</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><b> </b>Upgrade Domain resource</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html">Prepare to run a domain</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><b> </b>Upgrade managed domains</a><ul id="R-subsections-ccbca7935ed481eeab6222c998578048" class="collapsible-menu"></ul></li>
            <li class="parent alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><b> </b>Domain on Persistent Volume (PV)</a><ul id="R-subsections-d40ed8eea8326dbcd46326f7659b3e4f" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/overview/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/overview/index.html"><b> </b>Overview</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html"><b> </b>Usage</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/domain-creation-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/domain-creation-images/index.html"><b> </b>Domain creation images</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/model-files/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/model-files/index.html"><b> </b>Working with WDT model files</a></li>
            <li class="active " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html"><b> </b>JRF domains</a></li></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><b> </b>Model in Image</a><ul id="R-subsections-d9db9d9e38880e56d7ba5514a8527a97" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><b> </b>Configuration overrides</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><b> </b>Persistent storage</a><ul id="R-subsections-661be2f02fd0ae2ad3377779776a4545" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><b> </b>Access and monitor domains</a><ul id="R-subsections-5f509e3b856bccb56052229a523c07b3" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><b> </b>Domain life cycle</a><ul id="R-subsections-47783ab45f0ad76897c1eb1a21f9e6e7" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html">CI/CD considerations</a><ul id="R-subsections-8802c993ce14e9bb7903113fc1be4858" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html">Manage FMW Infrastructure domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html">Azure Kubernetes Service (AKS)</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><b> </b>Domain debugging</a></li></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><b> </b>WebLogic images</a><ul id="R-subsections-b3440c9f2ce961fe2579290479f05e53" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><b> </b>Samples</a><ul id="R-subsections-88c2b1e6419b221ce89c4be4a8ae2a6b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><b> </b>Developer Guide</a><ul id="R-subsections-6d5a8d333894e1a8a4ced31c7a69170c" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><b> </b>Reference</a><ul id="R-subsections-66002f201bef818664bb81aa67490c58" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><b> </b>Security</a><ul id="R-subsections-66815ecaaecfc1c209e5637d03b258b2" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html">Frequently asked questions</a><ul id="R-subsections-24e4fc446616bf2bbeac7b1dba804bb8" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html">Deprecated functionality</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html">Known limitations</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer">

<p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp</p>
<p><a href="https://github.com/oracle/weblogic-kubernetes-operator"><i class="fab fa-github"></i> GitHub repo</a></p>
<p><a href="https://join.slack.com/t/oracle-weblogic/shared_invite/zt-1ni1gtjv6-PGC6CQ4uIte3KBdm_67~aQ"><i class="fab fa-slack"></i> Public Slack #weblogic</a></p>
</div>
      </div>
    </aside>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/perfect-scrollbar/perfect-scrollbar.min.js?1768967398" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/theme.min.js?1768967398" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
