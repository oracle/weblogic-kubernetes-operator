<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.153.0">
    <meta name="generator" content="Relearn 8.3.0">
    <meta name="description" content="Instructions for using Domain on PV.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Usage :: WebLogic Kubernetes Operator">
    <meta name="twitter:description" content="Instructions for using Domain on PV.">
    <meta property="og:url" content="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html">
    <meta property="og:site_name" content="WebLogic Kubernetes Operator">
    <meta property="og:title" content="Usage :: WebLogic Kubernetes Operator">
    <meta property="og:description" content="Instructions for using Domain on PV.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Manage domains">
    <meta property="article:published_time" content="2023-04-26T16:45:16-05:00">
    <meta property="article:modified_time" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="name" content="Usage :: WebLogic Kubernetes Operator">
    <meta itemprop="description" content="Instructions for using Domain on PV.">
    <meta itemprop="datePublished" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="dateModified" content="2023-04-26T16:45:16-05:00">
    <meta itemprop="wordCount" content="3152">
    <title>Usage :: WebLogic Kubernetes Operator</title>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/images/logo.png?1767930410" rel="icon" type="image/png">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/auto-complete/auto-complete.min.css?1767930410" rel="stylesheet">
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/auto-complete/auto-complete.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search-lunr.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search.min.js?1767930410" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="https://oracle.github.io/weblogic-kubernetes-operator/searchindex.en.js?1767930410";
    </script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.stemmer.support.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.multi.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.en.min.js?1767930410" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1767930410" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1767930410" rel="stylesheet"></noscript>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/perfect-scrollbar/perfect-scrollbar.min.css?1767930410" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/theme.min.css?1767930410" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/format-html.min.css?1767930410" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/managing-domains\/domain-on-pv\/usage\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/oracle.github.io\/weblogic-kubernetes-operator';
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'learn' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#weblogic-kubernetes-operator">WebLogic Kubernetes Operator</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#weblogic-base-image">WebLogic base image</a></li>
        <li><a href="#domain-creation-wdt-models">Domain creation WDT models</a></li>
        <li><a href="#optional-wdt-models-configmap">Optional WDT models ConfigMap</a></li>
        <li><a href="#using-wdt-model-encryption">Using WDT model encryption</a></li>
        <li><a href="#volumes-and-volumemounts-information">Volumes and VolumeMounts information</a></li>
        <li><a href="#persistent-volume-and-persistent-volume-claim">Persistent Volume and Persistent Volume Claim</a>
          <ul>
            <li><a href="#pv-and-pvc-requirements">PV and PVC requirements</a></li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
        <li><a href="#domain-information">Domain information</a></li>
      </ul>
    </li>
    <li><a href="#best-practices">Best practices</a>
      <ul>
        <li><a href="#back-up-the-jrf-domain-home-directory-and-database">Back up the JRF domain home directory and database</a></li>
        <li><a href="#store-the-opss-wallet-in-a-kubernetes-secret-and-update-opsswalletfilesecret-in-the-domain-resource">Store the OPSS wallet in a Kubernetes Secret and update <code>opss.walletFileSecret</code> in the domain resource</a></li>
        <li><a href="#recovering-the-domain-when-its-corrupted-or-in-other-disaster-scenarios">Recovering the domain when it&rsquo;s corrupted or in other disaster scenarios</a></li>
      </ul>
    </li>
    <li><a href="#troubleshooting">Troubleshooting</a></li>
    <li><a href="#cleanup">Cleanup</a></li>
    <li><a href="#configuration-example">Configuration example</a>
      <ul>
        <li><a href="#basic-configuration">Basic configuration</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><span itemprop="name">WebLogic Kubernetes Operator</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><span itemprop="name">Manage domains</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><span itemprop="name">Domain on Persistent Volume (PV)</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Usage</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/overview/index.html" title="Overview (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/domain-creation-images/index.html" title="Domain creation images (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable managing-domains" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>



<h1 id="usage">Usage</h1>



<p>This document describes how to create and deploy a typical Domain home on persistent volume (Domain on PV).</p>
<h3 id="contents">Contents</h3>
<div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#weblogic-kubernetes-operator">WebLogic Kubernetes Operator</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#weblogic-base-image">WebLogic base image</a></li>
        <li><a href="#domain-creation-wdt-models">Domain creation WDT models</a></li>
        <li><a href="#optional-wdt-models-configmap">Optional WDT models ConfigMap</a></li>
        <li><a href="#using-wdt-model-encryption">Using WDT model encryption</a></li>
        <li><a href="#volumes-and-volumemounts-information">Volumes and VolumeMounts information</a></li>
        <li><a href="#persistent-volume-and-persistent-volume-claim">Persistent Volume and Persistent Volume Claim</a>
          <ul>
            <li><a href="#pv-and-pvc-requirements">PV and PVC requirements</a></li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
        <li><a href="#domain-information">Domain information</a></li>
      </ul>
    </li>
    <li><a href="#best-practices">Best practices</a>
      <ul>
        <li><a href="#back-up-the-jrf-domain-home-directory-and-database">Back up the JRF domain home directory and database</a></li>
        <li><a href="#store-the-opss-wallet-in-a-kubernetes-secret-and-update-opsswalletfilesecret-in-the-domain-resource">Store the OPSS wallet in a Kubernetes Secret and update <code>opss.walletFileSecret</code> in the domain resource</a></li>
        <li><a href="#recovering-the-domain-when-its-corrupted-or-in-other-disaster-scenarios">Recovering the domain when it&rsquo;s corrupted or in other disaster scenarios</a></li>
      </ul>
    </li>
    <li><a href="#troubleshooting">Troubleshooting</a></li>
    <li><a href="#cleanup">Cleanup</a></li>
    <li><a href="#configuration-example">Configuration example</a>
      <ul>
        <li><a href="#basic-configuration">Basic configuration</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
<h3 id="weblogic-kubernetes-operator">WebLogic Kubernetes Operator<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Deploy the operator and ensure that it is monitoring the desired namespace for your Domain on PV domain. See 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/"
   
   >
Manage operators
</a>
 and 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/"
   
   >
Quick Start
</a>
.</p>
<h3 id="configuration">Configuration<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Beginning with operator version 4.1.0, you can provide a section, <code>domain.spec.configuration.initializeDomainOnPV</code>, to initialize a WebLogic domain on a persistent volume when it is first deployed.
This is a <em>one time only</em> initialization. After the domain is created, subsequent updates to this section in the domain resource YAML file will not recreate or update the
WebLogic domain.</p>
<p>To use this feature, provide the following information:</p>
<ul>
<li>

<a href="#weblogic-base-image"
   
   >
WebLogic base image
</a>
 - This is the Fusion Middleware Software to be used, for example, WebLogic Server or Fusion Middleware Infrastructure.</li>
<li>

<a href="#volumes-and-volumemounts-information"
   
   >
Volumes and VolumeMounts information
</a>
 - This follows the standard Kubernetes pod requirements for mounting persistent volumes.</li>
<li>

<a href="#persistent-volume-and-persistent-volume-claim"
   
   >
PersistentVolume and PersistentVolumeClaim
</a>
 - This is environment specific and usually requires assistance from your administrator to provide the underlying details, such as <code>storageClass</code> or any permissions.</li>
<li>

<a href="#domain-information"
   
   >
Domain information
</a>
 - This describes the domain type and whether the operator should create the RCU schema.</li>
<li>

<a href="#domain-creation-models"
   
   >
Domain WDT models
</a>
 - This is where the WDT Home, WDT model, WDT archive, and WDT variables files reside.</li>
<li>

<a href="#optional-wdt-models-configmap"
   
   >
Optional WDT models ConfigMap
</a>
 - Optional, WDT model, WDT variables files.</li>
<li>

<a href="#using-wdt-model-encryption"
   
   >
Using WDT model encryption
</a>
 - Optional, using WDT model encryption.</li>
<li>

<a href="https://oracle.github.io/weblogic-kubernetes-operator/reference/domain-resource/"
   
   >
Domain resource YAML file
</a>
 - This is for deploying the domain in WebLogic Kubernetes Operator.</li>
</ul>
<p>For details about each field, see the <code>initializeDomainOnPV</code> section
in the domain resource


<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/documentation/domains/Domain.md"
   
   
target="_blank" rel="noopener noreferrer"
>
schema
</a>
,
or use the command <code>kubectl explain domain.spec.configuration.initializeDomainOnPV</code>.</p>
<p>For a basic configuration example, see 

<a href="#basic-configuration"
   
   >
Basic configuration
</a>
.</p>
<h4 id="weblogic-base-image">WebLogic base image<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Because the domain will be created on a persistent volume, the base image should contain only the FMW product binary and the JDK.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>spec:
  image: &#34;container-registry.oracle.com/middleware/fmw-infrastructure_cpu:12.2.1.4-jdk8-ol8-221014&#34;</code></pre></div>
<p>You can specify your own image, use a patched image from <code>container-registry.oracle.com</code>, or create and patch an image using the


<a href="https://github.com/oracle/weblogic-image-tool"
   
   
target="_blank" rel="noopener noreferrer"
>
WebLogic Image Tool
</a>
 (WIT).</p>
<h4 id="domain-creation-wdt-models">Domain creation WDT models<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Specify an image that describes the domain topology, resources, and applications in the domain resource YAML file.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>     domain:
          domainCreationImages:
            - image: &#39;myrepo/domain-images:v1&#39;</code></pre></div>
<table>
  <thead>
      <tr>
          <th>Field</th>
          <th>Notes</th>
          <th>Values</th>
          <th>Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>domainCreationImages</code></td>
          <td>WDT domain images.</td>
          <td>An array of images.</td>
          <td>Y</td>
      </tr>
  </tbody>
</table>
<p>In this image or images, you must provide the required WDT 

<a href="https://github.com/oracle/weblogic-deploy-tooling/releases"
   
   
target="_blank" rel="noopener noreferrer"
>
installer
</a>
,
and also the WDT model files, WDT variables files, and WDT archive files.  The operator will use them to create the initial domain.</p>
<p>For additional options in <code>domainCreationImages</code>, use the following command to obtain the details.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl explain domain.spec.configuration.initializeDomainOnPV.domain.domainCreationImages</code></pre></div>
<p>The image layout follows this directory structure:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>/auxiliary/weblogic-deploy - The directory where the WebLogic Deploy Tooling software is installed.
/auxiliary/models -  WDT model, WDT archive, and WDT variables files.</code></pre></div>
<p>You can create your own image using your familiar method or use the 

<a href="https://github.com/oracle/weblogic-image-tool"
   
   
target="_blank" rel="noopener noreferrer"
>
WebLogic Image Tool (WIT)
</a>
.</p>
<p>For example, because the file structure is the same as an 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/auxiliary-images/"
   
   >
Auxiliary Image
</a>
 that&rsquo;s used in the Model in Image domain home source type, you can
use the same WIT command <code>createAuxImage</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ imagetool.sh createAuxImage --wdtArchive /home/acme/myapp/wdt/myapp.zip \
   --wdtVersion latest \
   --wdtModel /home/acme/myapp/wdt/model1.yaml \
   --wdtVariables /home/acme/myapp/wdt/model1.properties \
   --tag myrepo/domain-images:v1   </code></pre></div>
<h4 id="optional-wdt-models-configmap">Optional WDT models ConfigMap<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Optionally, you can provide a Kubernetes ConfigMap with additional WDT models and WDT variables files as supplements or overrides to
those in <code>domainCreationImages</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>     domain:
          ...
          domainCreationImages:
              ...
          domainCreationConfigMap: mymodel-domain-configmap</code></pre></div>
<table>
  <thead>
      <tr>
          <th>Field</th>
          <th>Notes</th>
          <th>Values</th>
          <th>Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>domainCreationConfigMap</code></td>
          <td>Optional WDT models and WDT variables files in ConfigMap.</td>
          <td>ConfigMap name.</td>
          <td>N</td>
      </tr>
  </tbody>
</table>
<p>The files inside this ConfigMap must have file extensions, <code>.yaml</code>, <code>.properties</code>, or <code>.zip</code>.</p>
<h4 id="using-wdt-model-encryption">Using WDT model encryption<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Starting in WebLogic Kubernetes Operator version 4.2.16.  If the provided WDT models are encrypted using the WDT <code>encryptModel</code>
command.  You can specify the encryption passphrase as a secret in the domain resource YAML. WDT will use the value in the
secret to decrypt the models for domain creation.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>   <span style="color:#f92672">initializeDomainOnPV</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">modelEncryptionPassphraseSecret</span>: <span style="color:#ae81ff">model-encryption-secret</span></span></span></code></pre></div>
<p>The secret must have a key <code>passphrase</code> containing the value of the WDT encryption passphrase used to encrypt the models.</p>
<p><code>kubectl create secret generic model-encrypion-secret --from-literal=passphrase=&lt;encryption passphrase value&gt;</code></p>
<h4 id="volumes-and-volumemounts-information">Volumes and VolumeMounts information<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>You must provide the <code>volumes</code> and <code>volumeMounts</code> information in <code>domain.spec.serverPod</code>. This allows the pod to mount the persistent
storage at runtime.  The <code>mountPath</code> needs to be part of the domain home and log home and <code>persistentVolumeClaim.claimName</code> needs to
be a valid PVC name, whether it is a pre-existing PVC or one to be created by the operator.  See 

<a href="#persistent-volume-and-persistent-volume-claim"
   
   >
Creating PVC by the operator
</a>
.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">domainHome</span>: <span style="color:#ae81ff">/share/domains/domain1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">logHome</span>: <span style="color:#ae81ff">/share/logs/domain1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">serverPod</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">weblogic-domain-storage-volume</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">persistentVolumeClaim</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">claimName</span>: <span style="color:#ae81ff">sample-domain1-pvc-rwm1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumeMounts</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/share</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">weblogic-domain-storage-volume</span></span></span></code></pre></div>
<h4 id="persistent-volume-and-persistent-volume-claim">Persistent Volume and Persistent Volume Claim<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>The Kubernetes PersistentVolume (PV) and PersistentVolumeClaim (PVC) is used by Kubernetes to access
persistent storage in the Kubernetes environment. You can either use an existing PV/PVC or request that the operator create them
for you.</p>
<p>The specifications of <code>PersistentVolume</code> and <code>PersistentVolumeClaim</code> are environment specific and often require information
from your Kubernetes cluster administrator. See 

<a href="#references"
   
   >
Persistent Storage
</a>
 in different environments.</p>
<h5 id="pv-and-pvc-requirements">PV and PVC requirements<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h5>
<ul>
<li>Domain on PV requires that the PV and PVC are created with <code>Filesystem</code> volume mode; <code>Block</code> volume mode is <strong>not</strong> supported.
<ul>
<li>If you request that the operator creates the PV and PVC, then it uses the default <code>Filesystem</code> volume mode.</li>
<li>If you plan to use an existing PV and PVC, then ensure that it was created with <code>Filesystem</code> volume mode.</li>
</ul>
</li>
<li>You must use a storage provider that supports the <code>ReadWriteMany</code> option.</li>
<li>The operator will automatically set the owner of all files in the domain home on the persistent volume to <code>uid 1000</code> with <code>gid 0</code>. If you want to use a different user and group, then configure the desired <code>runAsUser</code> and <code>runAsGroup</code> in the security context under the <code>spec.serverPod.podSecurityContext</code> section of the Domain YAML file. The operator will use these values when setting the owner for files in the domain home directory.</li>
</ul>
<p>For example, if you provide the specification of the <code>Persistent Volume</code> and <code>Persistent Volume Claim</code> in the domain resource YAML file,<br>
then the operator will create the <code>PV</code> and <code>PVC</code>, and mount the persistent volume to the <code>/share</code> directory.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>spec:
  domainHome: /share/domains/domain1
  serverPod:
    volumes:
    - name: weblogic-domain-storage-volume
      persistentVolumeClaim:
         claimName: sample-domain1-pvc-rwm1
    volumeMounts:
    - mountPath: /share
      name: weblogic-domain-storage-volume

  configuration:
    initializeDomainOnPV:
      waitForPvcToBind: true
      persistentVolume:
        metadata:
            name: sample-domain1-pv-rwm1
        spec:
            storageClassName: my-storage-class
            capacity:
                storage: 20Gi
            persistentVolumeReclaimPolicy: Retain
            hostPath:
                path: &#34;/share&#34;
      persistentVolumeClaim:
        metadata:
            name: sample-domain1-pvc-rwm1
        spec:
            storageClassName: my-storage-class
            resources:
                requests:
                    storage: 10Gi</code></pre></div>
<table>
  <thead>
      <tr>
          <th>Field</th>
          <th>Notes</th>
          <th>Values</th>
          <th>Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>waitForPvcToBind</code></td>
          <td>Specify whether the operator will wait for the PVC to reach the <code>bound</code> state when it is creating it. In some cloud environments, the PVC is in the <code>pending</code> state until it is actually used in a running pod; set it to <code>false</code> if necessary.</td>
          <td>Boolean</td>
          <td>N (default <code>true</code>)</td>
      </tr>
      <tr>
          <td><code>persistentVolume</code></td>
          <td>Specification of the persistent volume if the operator is creating it.</td>
          <td>Specification of the persistent volume if you want the operator to create it.</td>
          <td>N  (operator will not create any persistent volume)</td>
      </tr>
      <tr>
          <td><code>persistentVolumeClaim</code></td>
          <td>Specification of the persistent volume claim if the operator is creating it.</td>
          <td>Specification of the persistent volume claim if you want operator to create it.</td>
          <td>N (operator will not create any persistent volume claim)</td>
      </tr>
  </tbody>
</table>
<p>Not all the fields in the standard Kubernetes PV and PVC are supported.  For the list of supported fields in <code>persistentVolume</code> and <code>persistentVolumeClaim</code>, see the <code>initializeDomainOnPV.peristentVolume</code> and <code>initializeDomainOnPV.peristentVolumeClaim</code> section
in the domain resource


<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/documentation/domains/Domain.md"
   
   
target="_blank" rel="noopener noreferrer"
>
schema
</a>
, or use the commands:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code> $ kubectl explain domain.spec.configuration.initializeDomainOnPV.persistentVolume
 $ kubectl explain domain.spec.configuration.initializeDomainOnPV.persistentVolumeClaim</code></pre></div>
<p>If the PV and PVC already exist in your environment, you do not need
to specify any <code>persistentVolume</code> or <code>persistentVolumeClaim</code>  under the <code>intializedDomainOnPV</code> section.</p>
<h4 id="references">References<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<ul>
<li>

<a href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengcreatingpersistentvolumeclaim.htm"
   
   
target="_blank" rel="noopener noreferrer"
>
Oracle Kubernetes Engine Persistent Storage
</a>
</li>
<li>

<a href="https://learn.microsoft.com/en-us/azure/aks/concepts-storage"
   
   
target="_blank" rel="noopener noreferrer"
>
Azure Kubernetes Service Persistent Storage
</a>
</li>
<li>

<a href="https://aws.amazon.com/blogs/storage/persistent-storage-for-kubernetes/"
   
   
target="_blank" rel="noopener noreferrer"
>
Amazon Kubernetes Service Persistent Storage
</a>
</li>
<li>

<a href="https://docs.openshift.com/container-platform/4.12/storage/understanding-persistent-storage.html"
   
   
target="_blank" rel="noopener noreferrer"
>
OpenShift Persistent Storage
</a>
</li>
</ul>
<h4 id="domain-information">Domain information<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p><strong>For JRF-based domains, before proceeding, please be sure to read this document</strong>, 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/"
   
   >
JRF domains
</a>
.</p>
<p>This is the section describing the WebLogic domain. For example:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>spec:
  domainHome: /share/domains/sample-domain1
  domainHomeSourceType: PersistentVolume

  configuration:
    secrets: [ sample-domain1-rcu-access ]
    initializeDomainOnPV:
      ...
      domain:
          # Domain | DomainAndRCU
          createIfNotExists: DomainAndRCU
          domainCreationImages:
            - image: &#39;myrepo/domain-images:v1&#39;
          domainType: JRF
          domainCreationConfigMap: sample-domain1-wdt-config-map
          opss:
           walletPasswordSecret: sample-domain1-opss-wallet-password-secret</code></pre></div>
<table>
  <thead>
      <tr>
          <th>Field</th>
          <th>Notes</th>
          <th>Values</th>
          <th>Required</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>domainType</code></td>
          <td>Type of domain being created.</td>
          <td><code>JRF</code> or <code>WLS</code></td>
          <td>N (default <code>WLS</code>)</td>
      </tr>
      <tr>
          <td><code>createIfNotExists</code></td>
          <td>Specifies whether the operator should create the RCU schema first, before creating the domain.</td>
          <td><code>Domain</code> or <code>DomainAndRCU</code> (drop existing RCU schema and create new RCU schema)</td>
          <td>N (default <code>Domain</code>)</td>
      </tr>
      <tr>
          <td><code>domainCreationImages</code></td>
          <td>WDT domain images.</td>
          <td>An array of images.</td>
          <td>Y</td>
      </tr>
      <tr>
          <td><code>domainCreationConfigMap</code></td>
          <td>Optional ConfigMap containing extra WDT models.</td>
          <td>Kubernetes ConfigMap name.</td>
          <td>N</td>
      </tr>
      <tr>
          <td><code>osss.walletPasswordSecret</code></td>
          <td>Password for extracting OPSS wallet for JRF domain.</td>
          <td>Kubernetes Secret name with the key <code>walletPassword</code>.</td>
          <td>Y</td>
      </tr>
      <tr>
          <td><code>osss.walletFileSecret</code></td>
          <td>Extracted OPSS wallet file.</td>
          <td>Kubernetes Secret name with the key <code>walletFile</code>.</td>
          <td>N (Only needed when recreating the domain during disaster recovery)</td>
      </tr>
  </tbody>
</table>
<p><strong>After a JRF domain is successfully deployed</strong>: follow the next section, 

<a href="#best-practices"
   
   >
Best practices
</a>
, to download and back up the OPSS wallet.</p>
<h3 id="best-practices">Best practices<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Oracle recommends that you save the OPSS wallet file in a safe, backed-up location <strong>immediately</strong> after the initial JRF domain is created.
In addition, you should make sure to store the wallet in a Kubernetes Secret in the same namespace. This will allow the secret to be available when the domain needs to be recovered in a disaster scenario or if the domain directory gets corrupted. There is no way to reuse the original RCU schema without this specific wallet key.
Therefore, for disaster recovery, <strong>you should back up this OPSS wallet</strong>.</p>
<h4 id="back-up-the-jrf-domain-home-directory-and-database">Back up the JRF domain home directory and database<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Oracle recommends that you back up the domain home directory and database after the initial JRF domain is created, and then periodically, making sure all the latest changes are backed up.</p>
<p>A JRF domain has a one-to-one relationship with the RCU schema.  After a domain is created using a particular RCU schema,
that schema <em>cannot</em> be reused by another domain and the same schema <em>cannot</em> be shared across different domains. Any attempts to
create a new domain using the existing RCU schema will result in an error.</p>

<details open class="box cstyle notices warning">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-triangle"></i> 
    Warning
  </summary>
  <div class="box-content">
<p>If the domain home is not properly backed up, you potentially can lose existing data if the domain home is corrupted or deleted.
That&rsquo;s because recreating the domain requires dropping the existing RCU schema and creating a new RCU schema. Therefore, backing up the existing domain home should be
the highest priority in your Kubernetes environment.</p>
  </div>
</details>
<p>A Domain on PV domain configuration might get updated after its initial deployment. For example, using WLST or the console, you might have deployed
new applications, added custom OPSS keystores, and added OWSM policies, and such.
In that case, the original WDT model files used to create the initial domain will <em>not</em> match the current state of the domain (the WDT model files are <em>not</em> the source of truth).
Therefore, if you recreate the domain using the original WDT model files, you will lose all the subsequent updates. In order to preserve the domain updates, you should restore the domain from
the backup copy of the domain home directory and connect to the existing RCU schema from the database backup.</p>
<h4 id="store-the-opss-wallet-in-a-kubernetes-secret-and-update-opsswalletfilesecret-in-the-domain-resource">Store the OPSS wallet in a Kubernetes Secret and update <code>opss.walletFileSecret</code> in the domain resource<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>After the domain is created, the operator automatically exports the OPSS wallet and stores it in an introspector ConfigMap; the name of the ConfigMap follows the pattern <code>&lt;domain uid&gt;-weblogic-domain-introspect-cm</code> with the key <code>ewallet.p12</code>. Oracle recommends that you save the OPSS wallet file in a safe, backed-up location <strong>immediately</strong> after the initial JRF domain is created. In addition, you should make sure to store the wallet in a Kubernetes Secret in the same namespace. This will allow the secret to be available when the domain needs to be recovered in a disaster scenario or if the domain directory gets corrupted.</p>
<p>The following are the high-level steps for storing the OPSS wallet in a Kubernetes Secret.</p>
<ol>
<li>
<p>The operator provides a utility script, 

<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/kubernetes/samples/scripts/domain-lifecycle/opss-wallet.sh"
   
   
target="_blank" rel="noopener noreferrer"
>
OPSS wallet utility
</a>
, for extracting the wallet file and storing it in a Kubernetes <code>walletFileSecret</code>. In addition, you should also save the wallet file in a safely backed-up location outside of Kubernetes. For example, the following command saves the OPSS wallet for the <code>sample-domain1</code> domain in the <code>sample-ns</code> namespace to a file named <code>ewallet.p12</code> in the <code>/tmp</code> directory and also stores it in the wallet secret named <code>jrf-wallet-file-secret</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ opss-wallet.sh -n sample-ns -d sample-domain1 -s -r -wf /tmp/ewallet.p12 -ws jrf-wallet-file-secret</code></pre></div>
<p>Replace <code>/tmp/ewallet.p12</code> in the previous command with the name of the file to be stored in a safe location and replace <code>jrf-wallet-file-secret</code> with the Secret name of your choice. For more information, see the <code>OPSS wallet utility</code> section in the 

<a href="https://github.com/oracle/weblogic-kubernetes-operator/tree/main/kubernetes/samples/scripts/domain-lifecycle/README.md"
   
   
target="_blank" rel="noopener noreferrer"
>
README
</a>
 file.</p>
</li>
<li>
<p>Save the extracted wallet file (<code>/tmp/ewallet.p12</code> in the example) to a safe location, outside of Kubernetes.</p>
</li>
<li>
<p>Add the <code>opss.walletFileSecret</code> to the domain resource YAML file under <code>configuration.initializeDomainOnPV.domain</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>  ...
  configuration:
    initializeDomainOnPV:
    ...
      domain:
        ...
        opss:
          walletFileSecret: jrf-wallet-file-secret
          ...</code></pre></div>
<p>You can use the following <code>patch</code> command to add it to the domain resource.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;add&#34;, &#34;path&#34; : &#34;/spec/configuration/initializeDomainOnPV/domain/opss/walletFileSecret&#34;, &#34;value&#34; : &#34;jrf-wallet-file-secret&#34; }]&#39;</code></pre></div>
</li>
</ol>
<h4 id="recovering-the-domain-when-its-corrupted-or-in-other-disaster-scenarios">Recovering the domain when it&rsquo;s corrupted or in other disaster scenarios<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>If the domain home directory is corrupted, and you have a recent backup of the domain home directory, then perform the following steps to recover the domain.</p>
<ol>
<li>
<p>Restore the domain home directory from the backup copy.</p>
</li>
<li>
<p>Update the <code>restartVersion</code> of the domain resource to restart the domain. For example,</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/restartVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>After the domain is restarted, check the WebLogic domain configuration to ensure that it has the latest changes.
<strong>NOTE</strong>: If you made any changes that are persisted in the domain home directory after your last backup, you must reapply those changes to the domain home directory.
However, because the operator will reconnect to the same RCU schema, the data stored in the OPSS, MDS, or OWSM tables will be current.</p>
</li>
<li>
<p>Reapply any domain configuration changes persisted to the domain home directory, such as
data source connections, JMS destinations, or new application EAR deployments, after your last backup. To make these changes, use WLST, the WebLogic Server Administration Console, or Enterprise Manager.</p>
</li>
</ol>
<p>In the rare scenario where the domain home directory is corrupted, and you do <strong>not</strong> have a recent backup of the domain home directory, or if the backup copy is also corrupted, then you can recreate the domain from the WDT model files without losing any RCU schema data.</p>
<ol>
<li>
<p>Delete the domain home directory from the persistent volume.</p>
</li>
<li>
<p>Add or replace the <code>domain.spec.introspectVersion</code> in the domain resource with a new value. The following is a sample <code>patch</code> command to update the <code>introspectVersion</code> for the sample domain.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/intropsectVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
<li>
<p>The operator will then create a new domain from the existing WDT models and reuse the original RCU schema.</p>
<p><strong>NOTE</strong>:
All the updates made to the domain after the initial deployment will <strong>not</strong> be available in the recovered domain.
However, this allows you to access the original RCU schema database without losing all its data.</p>
</li>
<li>
<p>Apply all the domain configuration changes persisted to the domain home file system, such as data source connections, JMS destinations, or new application EAR deployments, that are not in the WDT model files. These are the changes you have made <em>after</em> the initial domain deployment.</p>
</li>
<li>
<p>Update the <code>restartVersion</code> of the domain resource to restart the domain.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n sample-ns patch domain sample-domain1 --type=&#39;JSON&#39; -p=&#39;[ { &#34;op&#34; : &#34;replace&#34;, &#34;path&#34; : &#34;/spec/restartVersion&#34;, &#34;value&#34; : &#34;15&#34; }]&#39;</code></pre></div>
</li>
</ol>
<p>For more information, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/#disaster-recovery-for-domain-on-pv-deployment"
   
   >
Disaster Recovery
</a>
.</p>
<h3 id="troubleshooting">Troubleshooting<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p><strong>Problem</strong>: An error in the introspector job.</p>
<ul>
<li>
<p>Check the domain status of the domain.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n &lt;domain namespace&gt; get domain &lt;domain uid&gt;</code></pre></div>
</li>
<li>
<p>Check the domain log files in <code>logHome</code>.</p>
<p>By default, the operator persists the log files for the introspector job, RCU logs, and WebLogic server logs in <code>domain.spec.logHome</code>
(default: <code>/share/logs/&lt;domain uid&gt;</code>).</p>
<p>If there are errors, the related output files can be found in the <code>logHome</code> directory.  For example:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>admin-server.log                  
introspector_script.out
createDomain.log
wdt_output.log             
admin-server.out
...                 
rculogdir/**</code></pre></div>
</li>
<li>
<p>Check the operator log.  Additional error messages may be available in the operator log.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n &lt;operator namespace&gt; logs &lt;operator pod name&gt;</code></pre></div>
</li>
<li>
<p>Check the Kubernetes events.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n &lt;domain namespace&gt; get events</code></pre></div>
</li>
</ul>
<p><strong>Problem</strong>: Updated the WDT models but changes are not reflected in the domain.</p>
<p>This is the expected behavior. The WDT domain models specified in the domain image or ConfigMap
is a <strong>one time only</strong> operation. They are used only for creating the initial domain. After the domain is created, they do not participate in the lifecycle operations.
You should use the WebLogic console, WLST, or other means to update the domain.  In order to use the updated models to recreate the domain, you must delete the domain home directory and
also the applications directory for the JRF domain (<code>applications/&lt;domain uid&gt;</code> under the parent of the domain home directory) before trying to create the domain again.</p>
<p>If you see any other error, then consult 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/"
   
   >
Debugging
</a>
</p>
<h3 id="cleanup">Cleanup<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>If you need to delete the domain home and the application directory for a JRF domain, to recover from an error or if there is a need to recreate the domain home, the domain home is
in the directory specified in <code>domain.spec.domainHome</code>, and the application directory for JRF domains (if not specified in your WDT model) is in
<code>&lt;parent directory of domain home&gt;/applications/&lt;domain uid&gt;</code>, you can:</p>
<ol>
<li>
<p>If the underlying storage volume is dynamically allocated, then delete the PVC with <code>ReclaimPolcy: delete</code> and recreate the PVC.</p>
</li>
<li>
<p>Attach a pod to the shared volume and then access the pod to remove the contents.  See the sample script,


<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/kubernetes/samples/scripts/domain-lifecycle/pv-pvc-helper.sh"
   
   
target="_blank" rel="noopener noreferrer"
>
PV and PVC helper script
</a>
.</p>
</li>
<li>
<p>Delete the domain resource.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ kubectl -n &lt;namespace&gt; delete -f &lt;domain resource YAML&gt;</code></pre></div>
</li>
</ol>
<h3 id="configuration-example">Configuration example<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>The following configuration example illustrates a basic configuration.</p>
<h4 id="basic-configuration">Basic configuration<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>spec:
  domainHome: /share/domains/sample-domain1
  domainHomeSourceType: PersistentVolume
  image: &#34;container-registry.oracle.com/middleware/fmw-infrastructure_cpu:12.2.1.4-jdk8-ol8-221014&#34;
  imagePullPolicy: &#34;IfNotPresent&#34;
  imagePullSecrets:
  - name: ocir-credentials
  webLogicCredentialsSecret:
    name: sample-domain1-weblogic-credentials
  logHomeEnabled: true
  logHome: /share/logs/sample-domain1
  serverPod:
    env:
    - name: JAVA_OPTIONS
      value: &#34;-Dweblogic.StdoutDebugEnabled=false -Dweblogic.security.SSL.ignoreHostnameVerification=true -Dweblogic.security.TrustKeyStore=DemoTrust -Dweblogic.debug.DebugManagementServicesResource=true&#34;
    - name: USER_MEM_ARGS
      value: &#34;-XX:+UseContainerSupport -Djava.security.egd=file:/dev/./urandom &#34;
    # set up pod to use persistent storage using pvc
    # domain home must be under the mountPath  
    volumes:
    - name: weblogic-domain-storage-volume
      persistentVolumeClaim:
         claimName: sample-domain1-pvc-rwm1
    volumeMounts:
    - mountPath: /share
      name: weblogic-domain-storage-volume
  clusters:
  - name: sample-domain1-cluster-1
  replicas: 2

  configuration:
    secrets: [ sample-domain1-rcu-access ]
    initializeDomainOnPV:
      persistentVolume:
        metadata:
            name: sample-domain1-pv-rwm1
        spec:
            storageClassName: my-storage-class
            capacity:
                storage: 20Gi
            persistentVolumeReclaimPolicy: Retain
            hostPath:
                path: &#34;/share&#34;
      persistentVolumeClaim:
        metadata:
            name: sample-domain1-pvc-rwm1
        spec:
            storageClassName: my-storage-class
            resources:
                requests:
                    storage: 10Gi
      domain:
          # Domain | DomainAndRCU
          createIfNotExists: DomainAndRCU
          domainCreationImages:
            - image: &#39;myrepo/domain-images:v1&#39;
          domainType: JRF
          domainCreationConfigMap: sample-domain1-wdt-config-map
          opss:
           walletPasswordSecret: sample-domain1-opss-wallet-password-secret</code></pre></div>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">


<a id="logo" href="https://oracle.github.io/weblogic-kubernetes-operator/">
  <img src="https://oracle.github.io/weblogic-kubernetes-operator//images/logo.png" height="90"><br/>
  WebLogic Kubernetes Operator
</a>

        </div>
        <search><form action="https://oracle.github.io/weblogic-kubernetes-operator/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><b> </b>Quick Start</a><ul id="R-subsections-d63193e927818b6cb77d9c791ea48a61" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><b> </b>Introduction</a><ul id="R-subsections-e1ed3a04f1f57a27be4a8d0eb274be18" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><b> </b>Manage operators</a><ul id="R-subsections-7d4cf64999b86ce8197c0bc43769472c" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html">Manage domains</a><ul id="R-subsections-45a55625d0c34b621eb1935c75fae249" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/manage-domains/index.html">About WebLogic domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/index.html">Choose a domain home source type</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/index.html"><b> </b>Domain and Cluster resources</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/upgrade-domain-resource/index.html"><b> </b>Upgrade Domain resource</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/index.html">Prepare to run a domain</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/major-weblogic-version-upgrade/index.html"><b> </b>Upgrade managed domains</a><ul id="R-subsections-ccbca7935ed481eeab6222c998578048" class="collapsible-menu"></ul></li>
            <li class="parent alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/index.html"><b> </b>Domain on Persistent Volume (PV)</a><ul id="R-subsections-d40ed8eea8326dbcd46326f7659b3e4f" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/overview/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/overview/index.html"><b> </b>Overview</a></li>
            <li class="active " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/usage/index.html"><b> </b>Usage</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/domain-creation-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/domain-creation-images/index.html"><b> </b>Domain creation images</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/model-files/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/model-files/index.html"><b> </b>Working with WDT model files</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-on-pv/jrf-domain/index.html"><b> </b>JRF domains</a></li></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/index.html"><b> </b>Model in Image</a><ul id="R-subsections-d9db9d9e38880e56d7ba5514a8527a97" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/configoverrides/index.html"><b> </b>Configuration overrides</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/persistent-storage/index.html"><b> </b>Persistent storage</a><ul id="R-subsections-661be2f02fd0ae2ad3377779776a4545" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/accessing-the-domain/index.html"><b> </b>Access and monitor domains</a><ul id="R-subsections-5f509e3b856bccb56052229a523c07b3" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-lifecycle/index.html"><b> </b>Domain life cycle</a><ul id="R-subsections-47783ab45f0ad76897c1eb1a21f9e6e7" class="collapsible-menu"></ul></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/cicd/index.html">CI/CD considerations</a><ul id="R-subsections-8802c993ce14e9bb7903113fc1be4858" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/managing-fmw-domains/index.html">Manage FMW Infrastructure domains</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/aks/index.html">Azure Kubernetes Service (AKS)</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/debugging/index.html"><b> </b>Domain debugging</a></li></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><b> </b>WebLogic images</a><ul id="R-subsections-b3440c9f2ce961fe2579290479f05e53" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><b> </b>Samples</a><ul id="R-subsections-88c2b1e6419b221ce89c4be4a8ae2a6b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><b> </b>Developer Guide</a><ul id="R-subsections-6d5a8d333894e1a8a4ced31c7a69170c" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><b> </b>Reference</a><ul id="R-subsections-66002f201bef818664bb81aa67490c58" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><b> </b>Security</a><ul id="R-subsections-66815ecaaecfc1c209e5637d03b258b2" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html">Frequently asked questions</a><ul id="R-subsections-24e4fc446616bf2bbeac7b1dba804bb8" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html">Deprecated functionality</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html">Known limitations</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer">

<p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp</p>
<p><a href="https://github.com/oracle/weblogic-kubernetes-operator"><i class="fab fa-github"></i> GitHub repo</a></p>
<p><a href="https://join.slack.com/t/oracle-weblogic/shared_invite/zt-1ni1gtjv6-PGC6CQ4uIte3KBdm_67~aQ"><i class="fab fa-slack"></i> Public Slack #weblogic</a></p>
</div>
      </div>
    </aside>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/perfect-scrollbar/perfect-scrollbar.min.js?1767930410" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/theme.min.js?1767930410" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
