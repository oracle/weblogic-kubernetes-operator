# Copyright 2018, Oracle Corporation and/or its affiliates.  All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at
# http://oss.oracle.com/licenses/upl.

apiVersion: "weblogic.oracle/v2"
kind: Domain
metadata:
  name: domain1
  namespace: domain_ns
spec:
  # Identify which Secret contains the WebLogic Admin credentials
  adminSecret:
    name: admin-secret
  # The name of the Admin Server
  asName: admin
  # The Admin Server's ListenPort
  asPort: 8001
  # The WebLogic Domain Name

  domainName: base_domain
  # The domainUID must be unique across the entire Kubernetes Cluster.   Each WebLogic Domain must
  # have its own unique domainUID.  This does not have to be the same as the Domain Name.  It is allowed
  # to have multiple Domains with the same Domain Name, but they MUST have different domainUID's.
  # The domainUID is also used to identify the Persistent Volume that belongs to/with this Domain.
  domainUID: test-domain

  replicas: 2

  # The Operator currently does not support other images
  image: "store/oracle/weblogic:12.2.1.3"
  # imagePullPolicy defaults to "Always" if image version is :latest
  imagePullPolicy: IfNotPresent
  # Identify which Secret contains the credentials for pulling the image
  imagePullSecrets:
  - name: pull-secret1
  - name: pull-secret2

  serverPod:
    env:
    - name: var1
      value: value0

  # Configured storage using nfs style
  storage:
    generated:
      storageSize: 8Gi
      nfs:
        server: thatServer
        path: /local/path

  # configured wls configuration overrides configmap name
  configOverrides: overrides-config-map

  # configured wls configuration overrides secret names
  configOverrideSecrets: [overrides-secret-1, overrides-secret-2]

  adminServer:
    # The Admin Server's NodePort (optional)
    nodePort: 7001
    serverPod:
      env:
      - name: var1
        value: value1

  # list of configurations per named server.
  managedServers:
    server1:
      # an (optional) list of environment variable to be set on the server
      serverPod:
        env:
        - name: JAVA_OPTIONS
          value: "-server"
        - name: USER_MEM_ARGS
          value: "-Xms64m -Xmx256m "
    server2:
      serverStartState: ADMIN
        
  # If you use this entry, then the rules will be applied to ALL servers that are members of the named clusters.
  clusters:
    cluster2:
      desiredState: "RUNNING"
      replicas: 5
      serverPod:
        env:
        - name: JAVA_OPTIONS
          value: "-verbose"
        - name: USER_MEM_ARGS
          value: "-Xms64m -Xmx256m "
