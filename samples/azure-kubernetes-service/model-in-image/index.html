<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.153.0">
    <meta name="generator" content="Relearn 8.3.0">
    <meta name="description" content="Sample for creating a WebLogic cluster on the Azure Kubernetes Service with model in image domain home source type.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Model in Image :: WebLogic Kubernetes Operator">
    <meta name="twitter:description" content="Sample for creating a WebLogic cluster on the Azure Kubernetes Service with model in image domain home source type.">
    <meta property="og:url" content="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/model-in-image/index.html">
    <meta property="og:site_name" content="WebLogic Kubernetes Operator">
    <meta property="og:title" content="Model in Image :: WebLogic Kubernetes Operator">
    <meta property="og:description" content="Sample for creating a WebLogic cluster on the Azure Kubernetes Service with model in image domain home source type.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Samples">
    <meta property="article:published_time" content="2020-11-24T18:22:31-05:00">
    <meta property="article:modified_time" content="2020-11-24T18:22:31-05:00">
    <meta itemprop="name" content="Model in Image :: WebLogic Kubernetes Operator">
    <meta itemprop="description" content="Sample for creating a WebLogic cluster on the Azure Kubernetes Service with model in image domain home source type.">
    <meta itemprop="datePublished" content="2020-11-24T18:22:31-05:00">
    <meta itemprop="dateModified" content="2020-11-24T18:22:31-05:00">
    <meta itemprop="wordCount" content="5043">
    <title>Model in Image :: WebLogic Kubernetes Operator</title>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/images/logo.png?1769918999" rel="icon" type="image/png">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/auto-complete/auto-complete.min.css?1769918999" rel="stylesheet">
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/auto-complete/auto-complete.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search-lunr.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/search.min.js?1769918999" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="https://oracle.github.io/weblogic-kubernetes-operator/searchindex.en.js?1769918999";
    </script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.stemmer.support.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.multi.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/lunr/lunr.en.min.js?1769918999" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1769918999" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://oracle.github.io/weblogic-kubernetes-operator/fonts/fontawesome/css/fontawesome-all.min.css?1769918999" rel="stylesheet"></noscript>
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/perfect-scrollbar/perfect-scrollbar.min.css?1769918999" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/theme.min.css?1769918999" rel="stylesheet">
    <link href="https://oracle.github.io/weblogic-kubernetes-operator/css/format-html.min.css?1769918999" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/samples\/azure-kubernetes-service\/model-in-image\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/oracle.github.io\/weblogic-kubernetes-operator';
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'learn' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/model-in-image/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#prerequisites">Prerequisites</a>
      <ul>
        <li><a href="#prepare-parameters">Prepare parameters</a></li>
        <li><a href="#oracle-container-registry">Oracle Container Registry</a></li>
        <li><a href="#sign-in-with-azure-cli">Sign in with Azure CLI</a></li>
        <li><a href="#download-the-weblogic-kubernetes-operator-sample">Download the WebLogic Kubernetes Operator sample</a></li>
      </ul>
    </li>
    <li><a href="#create-resource-group">Create Resource Group</a></li>
    <li><a href="#create-the-aks-cluster">Create the AKS cluster</a></li>
    <li><a href="#install-weblogic-kubernetes-operator">Install WebLogic Kubernetes Operator</a></li>
    <li><a href="#create-docker-image">Create Docker image</a>
      <ul>
        <li><a href="#image-creation-prerequisites">Image creation prerequisites</a></li>
        <li><a href="#image-creation---introduction">Image creation - Introduction</a></li>
        <li><a href="#understanding-your-first-archive">Understanding your first archive</a></li>
        <li><a href="#staging-a-zip-file-of-the-archive">Staging a ZIP file of the archive</a></li>
        <li><a href="#staging-model-files">Staging model files</a></li>
        <li><a href="#creating-the-image-with-wit">Creating the image with WIT</a></li>
        <li><a href="#pushing-the-image-to-azure-container-registry">Pushing the image to Azure Container Registry</a></li>
      </ul>
    </li>
    <li><a href="#create-weblogic-domain">Create WebLogic domain</a>
      <ul>
        <li><a href="#namespace">Namespace</a></li>
        <li><a href="#kubernetes-secrets-for-weblogic-image">Kubernetes Secrets for WebLogic image</a></li>
        <li><a href="#kubernetes-secrets-for-weblogic">Kubernetes Secrets for WebLogic</a></li>
        <li><a href="#domain-resource">Domain resource</a></li>
      </ul>
    </li>
    <li><a href="#invoke-the-web-application">Invoke the web application</a>
      <ul>
        <li><a href="#create-azure-load-balancer">Create Azure load balancer</a></li>
        <li><a href="#access-the-application">Access the application</a></li>
      </ul>
    </li>
    <li><a href="#rolling-updates">Rolling updates</a></li>
    <li><a href="#database-connection">Database connection</a></li>
    <li><a href="#clean-up-resources">Clean up resources</a></li>
    <li><a href="#troubleshooting">Troubleshooting</a></li>
    <li><a href="#useful-links">Useful links</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><span itemprop="name">WebLogic Kubernetes Operator</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><span itemprop="name">Samples</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/index.html"><span itemprop="name">Azure Kubernetes Service</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Model in Image</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/domain-on-pv/index.html" title="Domain home on a PV (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/index.html" title="Troubleshooting (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable samples" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>



<h1 id="model-in-image">Model in Image</h1>



<p>This sample demonstrates how to use the 

<a href="https://oracle.github.io/weblogic-kubernetes-operator"
   
   
target="_blank" rel="noopener noreferrer"
>
WebLogic Kubernetes Operator
</a>
 (hereafter &ldquo;the operator&rdquo;) to set up a WebLogic Server (WLS) cluster on the Azure Kubernetes Service (AKS) using the model in image domain home source type. After going through the steps, your WLS domain runs on an AKS cluster instance and you can manage your WLS domain by interacting with the operator.</p>
<h3 id="contents">Contents</h3>
<div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#prerequisites">Prerequisites</a>
      <ul>
        <li><a href="#prepare-parameters">Prepare parameters</a></li>
        <li><a href="#oracle-container-registry">Oracle Container Registry</a></li>
        <li><a href="#sign-in-with-azure-cli">Sign in with Azure CLI</a></li>
        <li><a href="#download-the-weblogic-kubernetes-operator-sample">Download the WebLogic Kubernetes Operator sample</a></li>
      </ul>
    </li>
    <li><a href="#create-resource-group">Create Resource Group</a></li>
    <li><a href="#create-the-aks-cluster">Create the AKS cluster</a></li>
    <li><a href="#install-weblogic-kubernetes-operator">Install WebLogic Kubernetes Operator</a></li>
    <li><a href="#create-docker-image">Create Docker image</a>
      <ul>
        <li><a href="#image-creation-prerequisites">Image creation prerequisites</a></li>
        <li><a href="#image-creation---introduction">Image creation - Introduction</a></li>
        <li><a href="#understanding-your-first-archive">Understanding your first archive</a></li>
        <li><a href="#staging-a-zip-file-of-the-archive">Staging a ZIP file of the archive</a></li>
        <li><a href="#staging-model-files">Staging model files</a></li>
        <li><a href="#creating-the-image-with-wit">Creating the image with WIT</a></li>
        <li><a href="#pushing-the-image-to-azure-container-registry">Pushing the image to Azure Container Registry</a></li>
      </ul>
    </li>
    <li><a href="#create-weblogic-domain">Create WebLogic domain</a>
      <ul>
        <li><a href="#namespace">Namespace</a></li>
        <li><a href="#kubernetes-secrets-for-weblogic-image">Kubernetes Secrets for WebLogic image</a></li>
        <li><a href="#kubernetes-secrets-for-weblogic">Kubernetes Secrets for WebLogic</a></li>
        <li><a href="#domain-resource">Domain resource</a></li>
      </ul>
    </li>
    <li><a href="#invoke-the-web-application">Invoke the web application</a>
      <ul>
        <li><a href="#create-azure-load-balancer">Create Azure load balancer</a></li>
        <li><a href="#access-the-application">Access the application</a></li>
      </ul>
    </li>
    <li><a href="#rolling-updates">Rolling updates</a></li>
    <li><a href="#database-connection">Database connection</a></li>
    <li><a href="#clean-up-resources">Clean up resources</a></li>
    <li><a href="#troubleshooting">Troubleshooting</a></li>
    <li><a href="#useful-links">Useful links</a></li>
  </ul>
</nav></div>
<h3 id="prerequisites">Prerequisites<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>This sample assumes the following prerequisite environment.</p>
<ul>
<li>If you don&rsquo;t have an 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/guides/developer/azure-developer-guide#understanding-accounts-subscriptions-and-billing%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/guides/developer/azure-developer-guide#understanding-accounts-subscriptions-and-billing"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Azure subscription
</a>
, create a</p>
<p>&lt;a href=&ldquo;

<a href="https://azure.microsoft.com/free/?ref=microsoft.com&amp;amp;utm_source=microsoft.com&amp;amp;utm_medium=docs&amp;amp;utm_campaign=visualstudio%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://azure.microsoft.com/free/?ref=microsoft.com&amp;utm_source=microsoft.com&amp;utm_medium=docs&amp;utm_campaign=visualstudio"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>free account
</a>
before you begin.</p>
<ul>
<li>It&rsquo;s recommended that the Azure identity you use to sign in and complete this article has either the 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#owner%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#owner"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Owner
</a>
role in the current subscription or the</p>
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Contributor
</a>
and</p>
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>User Access Administrator
</a>
roles in the current subscription.</li></p>
<li>If your identity has very limited role assignments, ensure you have 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Contributor
</a>
role and</p>
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>User Access Administrator
</a>
role in the resource group that runs the AKS cluster. This requires asking a privileged user to assign the roles before creating resources in the resource group.</li></p>
</ul>
</li>
<li>Operating System: GNU/Linux, macOS (Intel only, Apple Silicon not supported), 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/windows/wsl/install%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/windows/wsl/install"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Windows Subsystem for Linux (WSL)
</a>
.</li></p>
<li>
<p>&lt;a href=&ldquo;

<a href="https://git-scm.com/downloads%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://git-scm.com/downloads"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Git
</a>
; use <code>git &ndash;version</code> to test if <code>git</code> works.  This document was tested with version 2.25.1.</li></p>
<li>
<p>&lt;a href=&ldquo;

<a href="https://docs.microsoft.com/cli/azure%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://docs.microsoft.com/cli/azure"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Azure CLI
</a>
; use <code>az &ndash;version</code> to test if <code>az</code> works.  This document was tested with version 2.58.0.</li></p>
<li>
<p>&lt;a href=&ldquo;

<a href="https://www.docker.com/products/docker-desktop%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://www.docker.com/products/docker-desktop"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Docker for Desktop
</a>
.  This document was tested with <code>Docker version 20.10.7</code>.</li></p>
<li>
<p>&lt;a href=&ldquo;

<a href="https://kubernetes-io-vnext-staging.netlify.com/docs/tasks/tools/install-kubectl/%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://kubernetes-io-vnext-staging.netlify.com/docs/tasks/tools/install-kubectl/"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>kubectl
</a>
; use <code>kubectl version</code> to test if <code>kubectl</code> works.  This document was tested with version v1.21.2.</li></p>
<li>
<p>&lt;a href=&ldquo;

<a href="https://helm.sh/docs/intro/install/%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://helm.sh/docs/intro/install/"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Helm
</a>
, version 3.1 and later; use <code>helm version</code> to check the <code>helm</code> version.  This document was tested with version v3.6.2.</li></p>
<li>A JDK, version 8 or 11. Azure recommends 
<p>&lt;a href=&ldquo;

<a href="https://docs.microsoft.com/java/openjdk/download%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://docs.microsoft.com/java/openjdk/download"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Microsoft Build of OpenJDK
</a>
. Ensure that your <code>JAVA_HOME</code> environment variable is set correctly in the shells in which you run the commands.</li></p>
<li>Ensure that you have the zip/unzip utility installed; use <code>zip/unzip -v</code> to test if <code>zip/unzip</code> works.</li>
<li>You will need an Oracle account.</li>
</ul>
<h4 id="prepare-parameters">Prepare parameters<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Set required parameters by running the following commands.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Change these parameters as needed for your own environment</span>
</span></span><span style="display:flex;"><span>export ORACLE_SSO_EMAIL<span style="color:#f92672">=</span>&lt;replace with your oracle account email&gt;
</span></span><span style="display:flex;"><span>export ORACLE_SSO_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;replace with your oracle password.&gt;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>export BASE_DIR<span style="color:#f92672">=</span>~
</span></span><span style="display:flex;"><span>export NAME_PREFIX<span style="color:#f92672">=</span>wls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Used to generate resource names.</span>
</span></span><span style="display:flex;"><span>export TIMESTAMP<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>date +%s<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>export ACR_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;acr</span><span style="color:#e6db74">${</span>TIMESTAMP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>export AKS_CLUSTER_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks</span><span style="color:#e6db74">${</span>TIMESTAMP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>export AKS_PERS_RESOURCE_GROUP<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;resourcegroup</span><span style="color:#e6db74">${</span>TIMESTAMP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>export AKS_PERS_LOCATION<span style="color:#f92672">=</span>eastus
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>export SECRET_NAME_DOCKER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>NAME_PREFIX<span style="color:#e6db74">}</span><span style="color:#e6db74">regcred&#34;</span>
</span></span><span style="display:flex;"><span>export WEBLOGIC_USERNAME<span style="color:#f92672">=</span>weblogic
</span></span><span style="display:flex;"><span>export WEBLOGIC_PASSWORD<span style="color:#f92672">=</span>Secret123456
</span></span><span style="display:flex;"><span>export WEBLOGIC_WDT_PASSWORD<span style="color:#f92672">=</span>Secret123456</span></span></code></pre></div>
<h4 id="oracle-container-registry">Oracle Container Registry<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>The following steps will direct you to accept the license agreement for WebLogic Server. Make note of your Oracle Account password and email. This sample pertains to 12.2.1.4, but other versions may work as well.</p>
<ul>
<li>In a web browser, navigate to 
<p>&lt;a href=&ldquo;

<a href="https://container-registry.oracle.com"
   
   
target="_blank" rel="noopener noreferrer"
>
https://container-registry.oracle.com
</a>
&rdquo;</p>
<p>target=&quot;_blank&quot; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>

<a href="https://container-registry.oracle.com"
   
   
target="_blank" rel="noopener noreferrer"
>
https://container-registry.oracle.com
</a>

</a>
and log in using the Oracle Single Sign-On authentication service. If you do not already have SSO credentials, at the top of the page, click the <strong>Sign In</strong> link to create them.</li></p>
<li>The Oracle Container Registry provides a WebLogic 12.2.1.4 General Availability (GA) installation image that is used in this sample.
<ul>
<li>In the Oracle Container Registry, navigate to <strong>Middleware</strong>, then <strong>weblogic</strong>.</li>
<li>On the left, choose a language and accept the license agreement. You will then see a message such as: &ldquo;You last accepted the Oracle Standard Terms and Restrictions on 08/10/2020 at 06:12 AM Coordinated Universal Time (UTC).&rdquo;</li>
</ul>
</li>
<li><strong>NOTE</strong>: General Availability (GA) images are suitable for demonstration and development purposes <em>only</em> where the environments are not available from the public Internet; they are <strong>not
acceptable for production use</strong>. In production, you should always use CPU (patched) images
from the OCR
or create your images using the 
<p>&lt;a href=&ldquo;

<a href="https://oracle.github.io/weblogic-image-tool/userguide/tools/create-image/%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://oracle.github.io/weblogic-image-tool/userguide/tools/create-image/"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>WebLogic Image Tool
</a></p>
<p>(WIT) with the <code>&ndash;recommendedPatches</code> option. For more guidance,
see</p>
<p>&lt;a href=&ldquo;

<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/middleware/standalone/weblogic-server/14.1.1.0&amp;amp;id=LOCKD-GUID-2DA84185-46BA-4D7A-80D2-9D577A4E8DE2%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://www.oracle.com/pls/topic/lookup?ctx=en/middleware/standalone/weblogic-server/14.1.1.0&amp;id=LOCKD-GUID-2DA84185-46BA-4D7A-80D2-9D577A4E8DE2"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Apply the Latest Patches and Updates
</a></p>
<p>in <em>Securing a Production Environment for Oracle WebLogic Server</em>.</li></p>
<li>Ensure that Docker is running. Find and pull the WebLogic 12.2.1.4 installation image:
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker login container-registry.oracle.com -u <span style="color:#e6db74">${</span>ORACLE_SSO_EMAIL<span style="color:#e6db74">}</span> -p <span style="color:#e6db74">${</span>ORACLE_SSO_PASSWORD<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>$ docker pull container-registry.oracle.com/middleware/weblogic:14.1.2.0-generic-jdk17-ol8</span></span></code></pre></div>
</li>
</ul>
<p>If you have problems accessing the Oracle Container Registry, you can build your own images from the 
<p>&lt;a href=&ldquo;

<a href="https://github.com/oracle/docker-images/tree/main/OracleWebLogic/dockerfiles%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://github.com/oracle/docker-images/tree/main/OracleWebLogic/dockerfiles"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Oracle GitHub repository
</a>
.</p></p>
<h4 id="sign-in-with-azure-cli">Sign in with Azure CLI<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>The steps in this section show you how to sign in to the Azure CLI.</p>
<ol>
<li>
<p>Open a Bash shell.</p>
</li>
<li>
<p>Sign out and delete some authentication files to remove any lingering credentials.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az logout
</span></span><span style="display:flex;"><span>$ rm ~/.azure/accessTokens.json
</span></span><span style="display:flex;"><span>$ rm ~/.azure/azureProfile.json</span></span></code></pre></div>
</li>
<li>
<p>Sign in to your Azure CLI.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az login</span></span></code></pre></div>
</li>
<li>
<p>Set the subscription ID. Be sure to replace the placeholder with the appropriate value.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ export SUBSCRIPTION_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;your-sub-id&gt;&#34;</span>
</span></span><span style="display:flex;"><span>$ az account set -s $SUBSCRIPTION_ID</span></span></code></pre></div>
</li>
</ol>
<h4 id="download-the-weblogic-kubernetes-operator-sample">Download the WebLogic Kubernetes Operator sample<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Download the WebLogic Kubernetes Operator sample ZIP file. We will use several scripts in this zip file to create a WebLogic domain. This sample was tested with v4.2.8, but should work with the latest release.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cd $BASE_DIR
</span></span><span style="display:flex;"><span>$ mkdir sample-scripts
</span></span><span style="display:flex;"><span>$ curl -m <span style="color:#ae81ff">120</span> -fL https://github.com/oracle/weblogic-kubernetes-operator/releases/download/v4.2.8/sample-scripts.zip <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>      -o <span style="color:#e6db74">${</span>BASE_DIR<span style="color:#e6db74">}</span>/sample-scripts/sample-scripts.zip
</span></span><span style="display:flex;"><span>$ unzip <span style="color:#e6db74">${</span>BASE_DIR<span style="color:#e6db74">}</span>/sample-scripts/sample-scripts.zip -d <span style="color:#e6db74">${</span>BASE_DIR<span style="color:#e6db74">}</span>/sample-scripts</span></span></code></pre></div>
<h3 id="create-resource-group">Create Resource Group<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Create the resource group by issuing the following commands.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az extension add --name resource-graph
</span></span><span style="display:flex;"><span>$ az group create --name $AKS_PERS_RESOURCE_GROUP --location $AKS_PERS_LOCATION</span></span></code></pre></div>
<h3 id="create-the-aks-cluster">Create the AKS cluster<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>This sample doesn&rsquo;t enable application routing. If you want to enable application routing, follow 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/azure/aks/app-routing?tabs=default%2Cdeploy-app-default%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/azure/aks/app-routing?tabs=default%2Cdeploy-app-default"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Managed nginx Ingress with the application routing add-on in AKS
</a>
.</p></p>
<p>Run the following command to create the AKS cluster.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az aks create <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --resource-group $AKS_PERS_RESOURCE_GROUP <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --name $AKS_CLUSTER_NAME <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --node-count <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --generate-ssh-keys <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --nodepool-name nodepool1 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --node-vm-size Standard_DS2_v2 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --location $AKS_PERS_LOCATION <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --enable-managed-identity</span></span></code></pre></div>
<p>Successful output will be a JSON object with the entry <code>&quot;type&quot;: &quot;Microsoft.ContainerService/ManagedClusters&quot;</code>.</p>
<p>After the deployment finishes, run the following command to connect to the AKS cluster. This command updates your local <code>~/.kube/config</code> so that subsequent <code>kubectl</code> commands interact with the named AKS cluster.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az aks get-credentials --resource-group $AKS_PERS_RESOURCE_GROUP --name $AKS_CLUSTER_NAME</span></span></code></pre></div>
<p>Successful output will look similar to:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Merged <span style="color:#e6db74">&#34;wlsaks1596087429&#34;</span> as current context in /home/username/.kube/config</span></span></code></pre></div>
<p>After your Kubernetes cluster is up and running, run the following commands to make sure <code>kubectl</code> can access the Kubernetes cluster:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl get nodes -o wide</span></span></code></pre></div>
<p>Successful output will look like the following.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>NAME                                STATUS   ROLES   AGE    VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION      CONTAINER-RUNTIME
</span></span><span style="display:flex;"><span>aks-nodepool1-15679926-vmss000000   Ready    agent   118s   v1.25.6   10.224.0.4    &lt;none&gt;        Ubuntu 22.04.2 LTS   5.15.0-1041-azure   containerd://1.7.1+azure-1
</span></span><span style="display:flex;"><span>aks-nodepool1-15679926-vmss000001   Ready    agent   2m8s   v1.25.6   10.224.0.5    &lt;none&gt;        Ubuntu 22.04.2 LTS   5.15.0-1041-azure   containerd://1.7.1+azure-1</span></span></code></pre></div>
<p><strong>NOTE</strong>: If you run into VM size failure, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/#virtual-machine-size-is-not-supported"
   
   >
Troubleshooting - Virtual Machine size is not supported
</a>
.</p>
<h3 id="install-weblogic-kubernetes-operator">Install WebLogic Kubernetes Operator<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>The WebLogic Kubernetes Operator is an adapter to integrate WebLogic Server and Kubernetes, allowing Kubernetes to serve as container infrastructure hosting WLS instances. The operator runs as a Kubernetes Pod and stands ready to perform actions related to running WLS on Kubernetes.</p>
<p>Create a namespace and service account for the operator.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl create namespace sample-weblogic-operator-ns</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>namespace/sample-weblogic-operator-ns created</code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl create serviceaccount -n sample-weblogic-operator-ns sample-weblogic-operator-sa</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>serviceaccount/sample-weblogic-operator-sa created</code></pre></div>
<p>Validate the service account was created with this command.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-weblogic-operator-ns get serviceaccount</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                          SECRETS   AGE
default                       1         9m24s
sample-weblogic-operator-sa   1         9m5s</code></pre></div>
<p>Install the operator. The operatorâ€™s Helm chart is located in the kubernetes/charts/weblogic-operator directory. This sample installs the operator using Helm charts from GitHub. It may take you several minutes to install the operator.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ helm repo add weblogic-operator https://oracle.github.io/weblogic-kubernetes-operator/charts --force-update</span></span></code></pre></div>
<p>Update the repo to get the latest Helm charts. It is a best practice to do this every time before installing a new operator version. In this example, we are using a pinned version, but you may also find success if you use the latest version. In this case, you can omit the <code>--version</code> argument. Be warned that these instructions have only been tested with the exact version shown.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ helm repo update
</span></span><span style="display:flex;"><span>$ helm install weblogic-operator weblogic-operator/weblogic-operator <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --namespace sample-weblogic-operator-ns <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --version 4.2.8 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --set serviceAccount<span style="color:#f92672">=</span>sample-weblogic-operator-sa <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --wait</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME: weblogic-operator
LAST DEPLOYED: Fri Aug 12 14:28:47 2022
NAMESPACE: sample-weblogic-operator-ns
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre></div>

<details open class="box cstyle notices tip">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-lightbulb"></i> 
    Tip
  </summary>
  <div class="box-content">
<p>If you wish to use a more recent version of the operator, replace the <code>4.2.8</code> in the preceding command with the other version number. To see the list of versions, visit the 

<a href="https://github.com/oracle/weblogic-kubernetes-operator/releases"
   
   
target="_blank" rel="noopener noreferrer"
>
GitHub releases page
</a>
.</p>
  </div>
</details>
<p>Verify the operator with the following commands; the status will be <code>Running</code>.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ helm list -A</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                    NAMESPACE                       REVISION        UPDATED                                 STATUS CHART                    APP VERSION
weblogic-operator       sample-weblogic-operator-ns     1               2023-05-15 10:31:05.1890341 +0800 CST   deployeweblogic-operator-4.2.8  4.2.8</code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl get pods -n sample-weblogic-operator-ns</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                                         READY   STATUS    RESTARTS   AGE
weblogic-operator-54b5c8df46-g4rcm           1/1     Running   0          86s
weblogic-operator-webhook-6c5885f69f-pd8qw   1/1     Running   0          86s</code></pre></div>

<details open class="box cstyle notices note">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-circle"></i> 
    Note
  </summary>
  <div class="box-content">
<p>You can specify the operator image by changing value of <code>--set image</code>. If you run into failures, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/#weblogic-kubernetes-operator-installation-failure"
   
   >
Troubleshooting - WebLogic Kubernetes Operator installation failure
</a>
.</p>
  </div>
</details>

<details open class="box cstyle notices info">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-info-circle"></i> 
    Info
  </summary>
  <div class="box-content">
<p>If you have an image built with domain models following 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/model-in-image/"
   
   >
Model in Image
</a>
, you can go to 

<a href="#create-weblogic-domain"
   
   >
Create WebLogic domain
</a>
 directly.</p>
  </div>
</details>
<h3 id="create-docker-image">Create Docker image<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<h4 id="image-creation-prerequisites">Image creation prerequisites<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<ul>
<li>
<p>The <code>JAVA_HOME</code> environment variable must be set and must reference a valid JDK 8 or 11 installation.</p>
</li>
<li>
<p>Copy the sample to a new directory; for example, use the directory <code>/tmp/mii-sample</code>. In the directory name, <code>mii</code> is short for &ldquo;model in image&rdquo;. Model in image is one of three domain home source types supported by the operator. To learn more, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/choosing-a-model/"
   
   >
Choose a domain home source type
</a>
.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ rm /tmp/mii-sample -f -r
</span></span><span style="display:flex;"><span>$ mkdir /tmp/mii-sample</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cp -r $BASE_DIR/sample-scripts/create-weblogic-domain/wdt-artifacts/* /tmp/mii-sample</span></span></code></pre></div>
<p>Save the model file directory.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ export WDT_MODEL_FILES_PATH<span style="color:#f92672">=</span>/tmp/mii-sample/wdt-model-files</span></span></code></pre></div>
<p><strong>NOTE</strong>: We will refer to this working copy of the sample as <code>/tmp/mii-sample</code>; however, you can use a different location.</p>
</li>
</ul>
<ul>
<li>
<p>Download the latest WebLogic Deploying Tooling (WDT) and WebLogic Image Tool (WIT) installer ZIP files to your <code>${WDT_MODEL_FILES_PATH}</code> directory. Both WDT and WIT are required to create your Model in Image images.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl -m <span style="color:#ae81ff">120</span> -fL https://github.com/oracle/weblogic-deploy-tooling/releases/latest/download/weblogic-deploy.zip <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span> -o <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/weblogic-deploy.zip</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl -m <span style="color:#ae81ff">120</span> -fL https://github.com/oracle/weblogic-image-tool/releases/latest/download/imagetool.zip <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -o <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/imagetool.zip</span></span></code></pre></div>
</li>
<li>
<p>Set up the WebLogic Image Tool, run the following commands:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ unzip <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/imagetool.zip -d <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>$ ${WDT_MODEL_FILES_PATH}/imagetool/bin/imagetool.sh cache deleteEntry --key wdt_latest</code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/imagetool/bin/imagetool.sh cache addInstaller <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --type wdt <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --version latest <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --path <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/weblogic-deploy.zip</span></span></code></pre></div>
<p>These steps will install WIT to the <code>${WDT_MODEL_FILES_PATH}/imagetool</code> directory, plus put a <code>wdt_latest</code> entry in the toolâ€™s cache which points to the WDT ZIP file installer. You will use WIT later in the sample for creating model images.</p>
</li>
</ul>
<h4 id="image-creation---introduction">Image creation - Introduction<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>The goal of image creation is to demonstrate using the WebLogic Image Tool to create an image tagged as <code>wdt-domain-image:WLS-v1</code> from files that you will stage to <code>${WDT_MODEL_FILES_PATH}/WLS-v1/</code>.</p>
<ul>
<li>The directory where the WebLogic Deploy Tooling software is installed (also known as WDT Home) is expected in an imageâ€™s <code>/auxiliary/weblogic-deploy</code> directory.</li>
<li>WDT model YAML (model), WDT variable (property), and WDT archive ZIP (archive) files are expected in directory <code>/auxiliary/models</code>.</li>
</ul>
<h4 id="understanding-your-first-archive">Understanding your first archive<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>See 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/model-in-image/auxiliary-image-creation/#understand-your-first-archive"
   
   >
Understanding your first archive
</a>
.</p>
<h4 id="staging-a-zip-file-of-the-archive">Staging a ZIP file of the archive<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>When you create the image, you will use the files in the staging directory, <code>${WDT_MODEL_FILES_PATH}/WLS-v1</code>. In preparation, you need it to contain a ZIP file of the WDT application archive.</p>
<p>Run the following commands to create your application archive ZIP file and put it in the expected directory:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Delete existing archive.zip in case we have an old leftover version</span>
</span></span><span style="display:flex;"><span>$ rm -f <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/WLS-v1/archive.zip</span></span></code></pre></div>
<p>Create a ZIP file of the archive in the location that we will use when we run the WebLogic Image Tool.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cd /tmp/mii-sample/archives/archive-v1
</span></span><span style="display:flex;"><span>$ zip -r <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/WLS-v1/archive.zip wlsdeploy</span></span></code></pre></div>
<h4 id="staging-model-files">Staging model files<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>In this step, you explore the staged WDT model YAML file and properties in the <code>${WDT_MODEL_FILES_PATH}/WLS-v1</code> directory. The model in this directory references the web application in your archive, configures a WebLogic Server Administration Server, and configures a WebLogic cluster. It consists of only two files, <code>model.10.properties</code>, a file with a single property, and, <code>model.10.yaml</code>, a YAML file with your WebLogic configuration.</p>
<p>Here is the WLS <code>model.10.properties</code>:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>CLUSTER_SIZE=5</code></pre></div>
<p>Here is the WLS <code>model.10.yaml</code>:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">domainInfo</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">AdminUserName</span>: <span style="color:#e6db74">&#39;@@SECRET:__weblogic-credentials__:username@@&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">AdminPassword</span>: <span style="color:#e6db74">&#39;@@SECRET:__weblogic-credentials__:password@@&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ServerStartMode</span>: <span style="color:#e6db74">&#39;prod&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">topology</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Name</span>: <span style="color:#e6db74">&#39;@@ENV:CUSTOM_DOMAIN_NAME@@&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">AdminServerName</span>: <span style="color:#e6db74">&#39;admin-server&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;cluster-1&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">DynamicServers</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">ServerTemplate</span>:  <span style="color:#e6db74">&#39;cluster-1-template&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">ServerNamePrefix</span>: <span style="color:#e6db74">&#39;managed-server&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">DynamicClusterSize</span>: <span style="color:#e6db74">&#39;@@PROP:CLUSTER_SIZE@@&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">MaxDynamicClusterSize</span>: <span style="color:#e6db74">&#39;@@PROP:CLUSTER_SIZE@@&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">MinDynamicClusterSize</span>: <span style="color:#e6db74">&#39;0&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">CalculatedListenPorts</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;admin-server&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">ListenPort</span>: <span style="color:#ae81ff">7001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ServerTemplate</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;cluster-1-template&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">Cluster</span>: <span style="color:#e6db74">&#39;cluster-1&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">ListenPort</span>: <span style="color:#ae81ff">8001</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">appDeployments</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Application</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">myapp</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">SourcePath</span>: <span style="color:#e6db74">&#39;wlsdeploy/applications/myapp-v1&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">ModuleType</span>: <span style="color:#ae81ff">ear</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">Target</span>: <span style="color:#e6db74">&#39;cluster-1&#39;</span></span></span></code></pre></div>
<p>The model file:</p>
<ul>
<li>
<p>Defines a WebLogic domain with:</p>
<ul>
<li>Cluster <code>cluster-1</code></li>
<li>Administration Server <code>admin-server</code></li>
<li>An EAR application, targeted to <code>cluster-1</code>, located in the WDT archive ZIP file at <code>wlsdeploy/applications/myapp-v1</code></li>
</ul>
</li>
<li>
<p>Leverages macros to inject external values:</p>
<ul>
<li>The property file <code>CLUSTER_SIZE</code> property is referenced in the model YAML file <code>DynamicClusterSize</code> and <code>MaxDynamicClusterSize</code> fields using a PROP macro.</li>
<li>The model file domain name is injected using a custom environment variable named <code>CUSTOM_DOMAIN_NAME</code> using an ENV macro.
<ul>
<li>You set this environment variable later in this sample using an <code>env</code> field in its Domain.</li>
<li><em>This conveniently provides a simple way to deploy multiple differently named domains using the same model image</em>.</li>
</ul>
</li>
<li>The model file administrator user name and password are set using a <code>weblogic-credentials</code> secret macro reference to the WebLogic credential secret.
<ul>
<li>This secret is in turn referenced using the <code>webLogicCredentialsSecret</code> field in the Domain.</li>
<li>The <code>weblogic-credentials</code> is a reserved name that always dereferences to the owning Domain actual WebLogic credentials secret name.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>A Model in Image image can contain multiple properties files, archive ZIP files, and YAML files but in this sample you use just one of each. For a complete description of Model in Images model file naming conventions, file loading order, and macro syntax, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/model-files/"
   
   >
Model files
</a>
 in the Model in Image user documentation.</p>
<h4 id="creating-the-image-with-wit">Creating the image with WIT<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>At this point, you have all of the files needed for <code>image wdt-domain-image:WLS-v1</code> staged; they include:</p>
<ul>
<li><code>/tmp/sample/wdt-artifacts/wdt-model-files/WLS-v1/model.10.yaml</code></li>
<li><code>/tmp/sample/wdt-artifacts/wdt-model-files/WLS-v1/model.10.properties</code></li>
<li><code>/tmp/sample/wdt-artifacts/wdt-model-files/WLS-v1/archive.zip</code></li>
</ul>
<p>Now, you use the Image Tool to create an image named <code>wdt-domain-image:WLS-v1</code>. Youâ€™ve already set up this tool during the prerequisite steps.</p>
<p>Run the following command to create the image and verify that it worked.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/imagetool/bin/imagetool.sh createAuxImage <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --tag wdt-domain-image:WLS-v1 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --wdtModel <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/WLS-v1/model.10.yaml <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --wdtVariables <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/WLS-v1/model.10.properties <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  --wdtArchive <span style="color:#e6db74">${</span>WDT_MODEL_FILES_PATH<span style="color:#e6db74">}</span>/WLS-v1/archive.zip</span></span></code></pre></div>
<p>This command runs the WebLogic Image Tool to create the domain creation image and does the following:</p>
<ul>
<li>Builds the final container image as a layer on a small <code>busybox</code> base image.</li>
<li>Copies the WDT ZIP file that&rsquo;s referenced in the WIT cache into the image.
<ul>
<li>Note that you cached WDT in WIT using the keyword <code>latest</code> when you set up the cache during the sample prerequisites steps.</li>
<li>This lets WIT implicitly assume it&rsquo;s the desired WDT version and removes the need to pass a <code>-wdtVersion</code> flag.</li>
</ul>
</li>
<li>Copies the specified WDT model, properties, and application archives to image location <code>/auxiliary/models</code>.</li>
</ul>
<p>When the command succeeds, it should end with output like the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>[INFO   ] Build successful. Build time=70s. Image tag=wdt-domain-image:WLS-v1</code></pre></div>
<p>Verify the image is available in the local Docker server with the following command.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker images | grep WLS-v1</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>wdt-domain-image          WLS-v1   012d3bfa3536   5 days ago      1.13GB</code></pre></div>

<details open class="box cstyle notices note">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-circle"></i> 
    Note
  </summary>
  <div class="box-content">
<p>The <code>imagetool.sh</code> is not supported on macOS with Apple Silicon. See 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/#exec-weblogic-operatorscriptsintrospectdomainsh-exec-format-error"
   
   >
Troubleshooting - exec format error
</a>
.</p>
  </div>
</details>

<details open class="box cstyle notices note">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-circle"></i> 
    Note
  </summary>
  <div class="box-content">
<p>You may run into a <code>Dockerfile</code> parsing error if your Docker buildkit is enabled, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/#weblogic-image-tool-failure"
   
   >
Troubleshooting - WebLogic Image Tool failure
</a>
.</p>
  </div>
</details>
<h4 id="pushing-the-image-to-azure-container-registry">Pushing the image to Azure Container Registry<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>AKS can pull images from any container registry, but the easiest integration is to use Azure Container Registry (ACR).  In addition to simplicity, using ACR simplifies high availability and disaster recovery with features such as geo-replication. For more information, see 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/container-registry/container-registry-geo-replication%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/container-registry/container-registry-geo-replication"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Geo-replication in Azure Container Registry
</a>
. In this section, we will create a new Azure Container Registry, connect it to our pre-existing AKS cluster and push the image built in the preceding section to it.  For complete details, see</p>
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/container-registry/%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/container-registry/"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Azure Container Registry documentation
</a>
.</p></p>
<p>Let&rsquo;s create an instance of ACR in the same resource group we used for AKS. We will use the environment variables used during the steps above.  For simplicity, we use the resource group name as the name of the ACR instance.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az acr create --resource-group $AKS_PERS_RESOURCE_GROUP --name $ACR_NAME --sku Basic --admin-enabled true</span></span></code></pre></div>
<p>Closely examine the JSON output from this command. Save the value of the <code>loginServer</code> property aside. It will look something like the following.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#e6db74">&#34;loginServer&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#34;contosoresourcegroup1610068510.azurecr.io&#34;</span><span style="color:#960050;background-color:#1e0010">,</span></span></span></code></pre></div>
<p>Use this value to sign in to the ACR instance. Note that because you are signing in with the <code>az</code> CLI, you do not need a password because your identity is already conveyed by having done <code>az login</code> previously.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ export LOGIN_SERVER<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>az acr show -n $ACR_NAME --resource-group $AKS_PERS_RESOURCE_GROUP --query <span style="color:#e6db74">&#34;loginServer&#34;</span> -o tsv<span style="color:#66d9ef">)</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az acr login --name $LOGIN_SERVER</span></span></code></pre></div>
<p>Successful output will include <code>Login Succeeded</code>.</p>
<p>Ensure Docker is running on your local machine.  Run the following commands to tag and push the image to your ACR.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker tag wdt-domain-image:WLS-v1 $LOGIN_SERVER/mii-aks-auxiliary-image:1.0</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker push $LOGIN_SERVER/mii-aks-auxiliary-image:1.0</span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>The push refers to repository [contosorgresourcegroup1610068510.azurecr.io/mii-aks-auxiliary-image]
1.0: digest: sha256:208217afe336053e4c524caeea1a415ccc9cc73b206ee58175d0acc5a3eeddd9 size: 2415</code></pre></div>
<p>Finally, connect the AKS cluster to the ACR. For more details on connecting ACR to an existing AKS, see 
<p>&lt;a href=&ldquo;

<a href="https://learn.microsoft.com/en-us/azure/aks/cluster-container-registry-integration?tabs=azure-cli#configure-acr-integration-for-an-existing-aks-cluster%22"
   
   
target="_blank" rel="noopener noreferrer"
>
https://learn.microsoft.com/en-us/azure/aks/cluster-container-registry-integration?tabs=azure-cli#configure-acr-integration-for-an-existing-aks-cluster"
</a>
</p>
<p>target=&quot;_blank&rdquo; rel=&ldquo;noopener noreferrer&rdquo;</p>
<blockquote>
</blockquote>
<p>Configure ACR integration for existing AKS clusters
</a>
.</p></p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ export ACR_ID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>az acr show -n $ACR_NAME --resource-group $AKS_PERS_RESOURCE_GROUP --query <span style="color:#e6db74">&#34;id&#34;</span> -o tsv<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>$ az aks update --name $AKS_CLUSTER_NAME --resource-group $AKS_PERS_RESOURCE_GROUP --attach-acr $ACR_ID</span></span></code></pre></div>
<p>Successful output will be a JSON object with the entry <code>&quot;type&quot;: &quot;Microsoft.ContainerService/ManagedClusters&quot;</code>.</p>
<p>If you see an error that seems related to you not being an <strong>Owner on this subscription</strong>, please refer to the troubleshooting section 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/#cannot-attach-acr-due-to-not-being-owner-of-subscription"
   
   >
Cannot attach ACR due to not being Owner of subscription
</a>
.</p>
<h3 id="create-weblogic-domain">Create WebLogic domain<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>In this section, you will deploy the new image to the namespace <code>sample-domain1-ns</code>, including the following steps:</p>
<ul>
<li>Create a namespace for the WebLogic domain.</li>
<li>Upgrade the operator to manage the WebLogic domain namespace.</li>
<li>Create a secret containing your WebLogic administrator user name and password.</li>
<li>Create a secret containing your Model in Image runtime encryption password:
<ul>
<li>All Model in Image domains must supply a runtime encryption Secret with a <code>password</code> value.</li>
<li>The runtime encryption password is used to encrypt configuration that is passed around internally by the operator.</li>
<li>The value must be kept private but can be arbitrary; you can optionally supply a different secret value every time you restart the domain.</li>
</ul>
</li>
<li>Deploy a domain YAML file that references the new image.</li>
<li>Wait for the domainâ€™s pods to start and reach their ready state.</li>
</ul>
<h4 id="namespace">Namespace<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Create a namespace that can host one or more domains:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl create namespace sample-domain1-ns</span></span></code></pre></div>
<p>Label the domain namespace so that the operator can autodetect and create WebLogic Server pods. Without this step, the operator cannot see the namespace.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl label namespace sample-domain1-ns weblogic-operator<span style="color:#f92672">=</span>enabled</span></span></code></pre></div>
<h4 id="kubernetes-secrets-for-weblogic-image">Kubernetes Secrets for WebLogic image<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>You will use the <code>kubernetes/samples/scripts/create-kubernetes-secrets/create-docker-credentials-secret.sh</code> script to create the Docker credentials as a Kubernetes secret to pull image from OCR. Please run:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ $BASE_DIR/sample-scripts/create-kubernetes-secrets/create-docker-credentials-secret.sh <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -n sample-domain1-ns <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -s <span style="color:#e6db74">${</span>SECRET_NAME_DOCKER<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -e <span style="color:#e6db74">${</span>ORACLE_SSO_EMAIL<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -p <span style="color:#e6db74">${</span>ORACLE_SSO_PASSWORD<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  -u <span style="color:#e6db74">${</span>ORACLE_SSO_EMAIL<span style="color:#e6db74">}</span></span></span></code></pre></div>
<p>The output will show something similar to the following:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>secret/wlsregcred created
The secret wlsregcred has been successfully created in the sample-domain1-ns namespace.</code></pre></div>
<h4 id="kubernetes-secrets-for-weblogic">Kubernetes Secrets for WebLogic<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>First, create the secrets needed by the WLS type model domain. For more on secrets in the context of running domains, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/prepare/"
   
   >
Prepare to run a domain
</a>
. In this case, you have two secrets.</p>
<p>Run the following <code>kubectl</code> commands to deploy the required secrets:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-domain1-ns create secret generic <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  sample-domain1-weblogic-credentials <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --from-literal<span style="color:#f92672">=</span>username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>WEBLOGIC_USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --from-literal<span style="color:#f92672">=</span>password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>WEBLOGIC_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-domain1-ns label  secret <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  sample-domain1-weblogic-credentials <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  weblogic.domainUID<span style="color:#f92672">=</span>sample-domain1</span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-domain1-ns create secret generic <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  sample-domain1-runtime-encryption-secret <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>   --from-literal<span style="color:#f92672">=</span>password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>WEBLOGIC_WDT_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl -n sample-domain1-ns label  secret <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  sample-domain1-runtime-encryption-secret <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span>  weblogic.domainUID<span style="color:#f92672">=</span>sample-domain1</span></span></code></pre></div>
<p>Some important details about these secrets:</p>
<ul>
<li>
<p>Make sure to enclose your values in double quotes and perform the necessary escaping to prevent the shell from modifying the values before the secret values are set.</p>
</li>
<li>
<p>Choosing passwords and user names:</p>
<ul>
<li>Set the variables <code>WEBLOGIC_USERNAME</code> and <code>WEBLOGIC_PASSWORD</code> with a user name and password of your choice.
The password should be at least eight characters long and include at least one digit.
Remember what you specified. These credentials may be needed again later.</li>
<li>Set the variable <code>WEBLOGIC_WDT_PASSWORD</code> with a password of your choice.</li>
</ul>
</li>
<li>
<p>The WebLogic credentials secret:</p>
<ul>
<li>It is required and must contain <code>username</code> and <code>password</code> fields.</li>
<li>It must be referenced by the <code>spec.webLogicCredentialsSecret</code> field in your Domain resource YAML file.  For complete details about the <code>Domain</code> resource, see the 

<a href="https://github.com/oracle/weblogic-kubernetes-operator/blob/main/documentation/domains/Domain.md#domain-spec"
   
   
target="_blank" rel="noopener noreferrer"
>
Domain resource reference
</a>
.</li>
<li>It also must be referenced by macros in the <code>domainInfo.AdminUserName</code> and <code>domainInfo.AdminPassWord</code> fields in your <code>model.10.yaml</code> file.</li>
</ul>
</li>
<li>
<p>The Model WDT runtime encryption secret:</p>
<ul>
<li>This is a special secret required by Model in Image.</li>
<li>It must contain a <code>password</code> field.</li>
<li>It must be referenced using the <code>spec.model.runtimeEncryptionSecret</code> field in your Domain resource YAML file.</li>
<li>It must remain the same for as long as the domain is deployed to Kubernetes but can be changed between deployments.</li>
<li>It is used to encrypt data as it&rsquo;s internally passed using log files from the domain&rsquo;s introspector job and on to its WebLogic Server pods.</li>
</ul>
</li>
<li>
<p>Deleting and recreating the secrets:</p>
<ul>
<li>You must delete a secret before creating it, otherwise the <code>create</code> command will fail if the secret already exists.</li>
<li>This allows you to change the secret when using the <code>kubectl create secret</code> command.</li>
</ul>
</li>
<li>
<p>You name and label secrets using their associated <code>domainUID</code> for two reasons:</p>
<ul>
<li>To make it obvious which secrets belong to which domains.</li>
<li>To make it easier to clean up a domain. Typical cleanup scripts use the <code>weblogic.domainUID</code> label as a convenience for finding all resources associated with a domain.</li>
</ul>
</li>
</ul>
<p>Now, you can verify the secrets with command:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get secrets -n sample-domain1-ns</span></span></code></pre></div>
<p>The output looks similar to the following content.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>NAME                                       TYPE                             DATA   AGE
</span></span><span style="display:flex;"><span>sample-domain1-runtime-encryption-secret   Opaque                           1      19s
</span></span><span style="display:flex;"><span>sample-domain1-weblogic-credentials        Opaque                           2      28s
</span></span><span style="display:flex;"><span>wlsregcred                                 kubernetes.io/dockerconfigjson   1      47s</span></span></code></pre></div>
<h4 id="domain-resource">Domain resource<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Now, you create a domain YAML file. Think of the domain YAML file as the way to configure some aspects of your WebLogic domain using Kubernetes.  The operator uses the Kubernetes &ldquo;custom resource&rdquo; feature to define a Kubernetes resource type called <code>Domain</code>.  For more on the <code>Domain</code> Kubernetes resource, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/domain-resource/"
   
   >
Domain Resource
</a>
. For more on custom resources see 

<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/"
   
   
target="_blank" rel="noopener noreferrer"
>
the Kubernetes documentation
</a>
.</p>
<p>We provide a script at <code>$BASE_DIR/sample-scripts/create-weblogic-domain-on-azure-kubernetes-service/create-domain-on-aks-mii-generate-yaml.sh</code> to generate a domain resource description.</p>
<p>Run the following command to generate resource files.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export Domain_Creation_Image_tag<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$LOGIN_SERVER<span style="color:#e6db74">/mii-aks-auxiliary-image:1.0&#34;</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cd $BASE_DIR
</span></span><span style="display:flex;"><span>$ bash $BASE_DIR/sample-scripts/create-weblogic-domain-on-azure-kubernetes-service/create-domain-on-aks-mii-generate-yaml.sh</span></span></code></pre></div>
<p>After running above commands, you will get three files: <code>mii-initial.yaml</code>, <code>admin-lb.yaml</code> and <code>cluster-lb.yaml</code>.</p>
<p>Run the following command to create the domain custom resource:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl apply -f mii-initial.yaml</span></span></code></pre></div>
<p>Successful output will look like:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>domain.weblogic.oracle/sample-domain1 created
cluster.weblogic.oracle/sample-domain1-cluster-1 created</code></pre></div>
<p>Verify the WebLogic Server pods are all running:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl get pods -n sample-domain1-ns --watch</span></span></code></pre></div>
<p>Output will look similar to the following.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                                READY   STATUS              RESTARTS   AGE
sample-domain1-introspector-xwpbn   0/1     ContainerCreating   0          0s
sample-domain1-introspector-xwpbn   1/1     Running             0          1s
sample-domain1-introspector-xwpbn   0/1     Completed           0          66s
sample-domain1-introspector-xwpbn   0/1     Terminating         0          67s
sample-domain1-introspector-xwpbn   0/1     Terminating         0          67s
sample-domain1-admin-server         0/1     Pending             0          0s
sample-domain1-admin-server         0/1     Pending             0          0s
sample-domain1-admin-server         0/1     ContainerCreating   0          0s
sample-domain1-admin-server         0/1     Running             0          2s
sample-domain1-admin-server         1/1     Running             0          42s
sample-domain1-managed-server1      0/1     Pending             0          0s
sample-domain1-managed-server1      0/1     Pending             0          0s
sample-domain1-managed-server1      0/1     ContainerCreating   0          0s
sample-domain1-managed-server2      0/1     Pending             0          0s
sample-domain1-managed-server2      0/1     Pending             0          0s
sample-domain1-managed-server2      0/1     ContainerCreating   0          0s
sample-domain1-managed-server2      0/1     Running             0          3s
sample-domain1-managed-server2      1/1     Running             0          40s
sample-domain1-managed-server1      0/1     Running             0          53s
sample-domain1-managed-server1      1/1     Running             0          93s</code></pre></div>
<p>When the system stabilizes with the following state, it is safe to proceed.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                             READY   STATUS    RESTARTS   AGE
sample-domain1-admin-server      1/1     Running   0          2m
sample-domain1-managed-server1   1/1     Running   0          83s
sample-domain1-managed-server2   1/1     Running   0          83s</code></pre></div>
<p>It may take you up to 10 minutes to deploy all pods, please wait and make sure everything is ready.</p>
<p>If the system does not reach this state, troubleshoot and resolve the problem before continuing. See 

<a href="#troubleshooting"
   
   >
Troubleshooting
</a>
 for hints.</p>
<h3 id="invoke-the-web-application">Invoke the web application<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<h4 id="create-azure-load-balancer">Create Azure load balancer<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Create an Azure public standard load balancer to access the WebLogic Server Administration Console and applications deployed to the cluster.</p>
<p>Use the file <code>admin-lb.yaml</code> to create a load balancer service for the Administration Server. If you are choosing not to use the predefined YAML file and instead created a new one with customized values, then substitute the following content with your domain values.</p>

<details class="box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Click here to view YAML content.
  </summary>
  <div class="box-content">
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">sample-domain1-admin-server-external-lb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">sample-domain1-ns</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">7001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">7001</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">weblogic.domainUID</span>: <span style="color:#ae81ff">sample-domain1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">weblogic.serverName</span>: <span style="color:#ae81ff">admin-server</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sessionAffinity</span>: <span style="color:#ae81ff">None</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">LoadBalancer</span></span></span></code></pre></div>
  </div>
</details>
<p>Use the file <code>cluster-lb.yaml</code> to create a load balancer service for the managed servers. If you are choosing not to use the predefined YAML file and instead created new one with customized values, then substitute the following content with your domain values.</p>

<details class="box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Click here to view YAML content.
  </summary>
  <div class="box-content">
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">sample-domain1-cluster-1-lb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">sample-domain1-ns</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">default</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">8001</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">weblogic.domainUID</span>: <span style="color:#ae81ff">sample-domain1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">weblogic.clusterName</span>: <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sessionAffinity</span>: <span style="color:#ae81ff">None</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">LoadBalancer</span></span></span></code></pre></div>
  </div>
</details>
<p>Create the load balancer services using the following commands:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl apply -f admin-lb.yaml</span></span></code></pre></div>
<p>Successful output will look like:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>service/sample-domain1-admin-server-external-lb created</code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl  apply -f cluster-lb.yaml</span></span></code></pre></div>
<p>Successful output will look like:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>service/sample-domain1-cluster-1-external-lb created</code></pre></div>
<p>Get the external IP addresses of the Administration Server and cluster load balancers (please wait for the external IP addresses to be assigned):</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl get svc -n sample-domain1-ns --watch</span></span></code></pre></div>
<p>Successful output will look like:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>NAME                                      TYPE           CLUSTER-IP     EXTERNAL-IP      PORT(S)          AGE
sample-domain1-admin-server               ClusterIP      None           &lt;none&gt;           7001/TCP         8m33s
sample-domain1-admin-server-external-lb   LoadBalancer   10.0.184.118   52.191.234.149   7001:30655/TCP   2m30s
sample-domain1-cluster-1-lb               LoadBalancer   10.0.76.7      52.191.235.71    8001:30439/TCP   2m25s
sample-domain1-cluster-cluster-1          ClusterIP      10.0.118.225   &lt;none&gt;           8001/TCP         7m53s
sample-domain1-managed-server1            ClusterIP      None           &lt;none&gt;           8001/TCP         7m53s
sample-domain1-managed-server2            ClusterIP      None           &lt;none&gt;           8001/TCP         7m52s</code></pre></div>
<p>In the example, the URL to access the Administration Server is: <code>http://52.191.234.149:7001/console</code>.
The expected username and password must match the values that you chose during the 

<a href="#kubernetes-secrets-for-weblogic"
   
   >
Kubernetes Secrets for WebLogic
</a>
 step.</p>
<p><strong>IMPORTANT:</strong> You must ensure that any Network Security Group rules that govern access to the console allow inbound traffic on port 7001.</p>
<p>If the WLS Administration Console is still not available, use <code>kubectl describe domain</code> to check domain status.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kubectl describe domain domain1</span></span></code></pre></div>
<p>Make sure the status of cluster-1 is <code>ServersReady</code> and <code>Available</code>.</p>

<details class="box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Click here to view example domain status.
  </summary>
  <div class="box-content">
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">Name</span>:         <span style="color:#ae81ff">sample-domain1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Namespace</span>:    <span style="color:#ae81ff">sample-domain1-ns</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Labels</span>:       <span style="color:#ae81ff">weblogic.domainUID=sample-domain1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Annotations</span>:  <span style="color:#ae81ff">&lt;none&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">API Version</span>:  <span style="color:#ae81ff">weblogic.oracle/v9</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Kind</span>:         <span style="color:#ae81ff">Domain</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Creation Timestamp</span>:  <span style="color:#e6db74">2020-11-30T05:40:11Z</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Generation</span>:          <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Resource Version</span>:    <span style="color:#ae81ff">9346</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Self Link</span>:           <span style="color:#ae81ff">/apis/weblogic.oracle/v9/namespaces/sample-domain1-ns/domains/sample-domain1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">UID</span>:                 <span style="color:#ae81ff">9f10a602-714a-46c5-8dcb-815616b587af</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Admin Server</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Start State</span>:  <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Clusters</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:  <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Replicas</span>:      <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Pod</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Affinity</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Pod Anti Affinity</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">Preferred During Scheduling Ignored During Execution</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">Pod Affinity Term</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">Label Selector</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">Match Expressions</span>:
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">Key</span>:       <span style="color:#ae81ff">weblogic.clusterName</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">Operator</span>:  <span style="color:#ae81ff">In</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">Values</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#ae81ff">$(CLUSTER_NAME)</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">Topology Key</span>:  <span style="color:#ae81ff">kubernetes.io/hostname</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">Weight</span>:          <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Start State</span>:      <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Configuration</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Model</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Domain Type</span>:                <span style="color:#ae81ff">WLS</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Runtime Encryption Secret</span>:  <span style="color:#ae81ff">sample-domain1-runtime-encryption-secret</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Domain Home</span>:                    <span style="color:#ae81ff">/u01/domains/sample-domain1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Domain Home Source Type</span>:        <span style="color:#ae81ff">FromModel</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Image</span>:                          <span style="color:#ae81ff">docker.io/sleepycat2/wls-on-aks:model-in-image</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Image Pull Policy</span>:              <span style="color:#ae81ff">IfNotPresent</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Image Pull Secrets</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Name</span>:                         <span style="color:#ae81ff">regsecret</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Include Server Out In Pod Log</span>:  <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Replicas</span>:                       <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Restart Version</span>:                <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Server Pod</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Env</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Name</span>:   <span style="color:#ae81ff">CUSTOM_DOMAIN_NAME</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Value</span>:  <span style="color:#ae81ff">domain1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Name</span>:   <span style="color:#ae81ff">JAVA_OPTIONS</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Value</span>:  -<span style="color:#ae81ff">Dweblogic.StdoutDebugEnabled=false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Name</span>:   <span style="color:#ae81ff">USER_MEM_ARGS</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Value</span>:  -<span style="color:#ae81ff">Djava.security.egd=file:/dev/./urandom -Xms256m -Xmx512m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Resources</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Requests</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Cpu</span>:            <span style="color:#ae81ff">250m</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Memory</span>:         <span style="color:#ae81ff">768Mi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Server Start Policy</span>:  <span style="color:#ae81ff">IfNeeded</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Web Logic Credentials Secret</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Name</span>:  <span style="color:#ae81ff">sample-domain1-weblogic-credentials</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Status</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Clusters</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:      <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Maximum Replicas</span>:  <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Minimum Replicas</span>:  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Ready Replicas</span>:    <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Replicas</span>:          <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Replicas Goal</span>:     <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Conditions</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Last Transition Time</span>:        <span style="color:#e6db74">2020-11-30T05:45:15.493Z</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Reason</span>:                      <span style="color:#ae81ff">ServersReady</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Status</span>:                      <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Type</span>:                        <span style="color:#ae81ff">Available</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Introspect Job Failure Count</span>:  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Replicas</span>:                      <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Servers</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Health</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Activation Time</span>:  <span style="color:#e6db74">2020-11-30T05:44:15.652Z</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Overall Health</span>:   <span style="color:#ae81ff">ok</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Subsystems</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Subsystem Name</span>:  <span style="color:#ae81ff">ServerRuntime</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Symptoms</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Node Name</span>:      <span style="color:#ae81ff">aks-pool1model-71528953-vmss000001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">admin-server</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">State</span>:          <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:   <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Health</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Activation Time</span>:  <span style="color:#e6db74">2020-11-30T05:44:54.699Z</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Overall Health</span>:   <span style="color:#ae81ff">ok</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Subsystems</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Subsystem Name</span>:  <span style="color:#ae81ff">ServerRuntime</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Symptoms</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Node Name</span>:      <span style="color:#ae81ff">aks-pool1model-71528953-vmss000000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">managed-server1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">State</span>:          <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:   <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Health</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Activation Time</span>:  <span style="color:#e6db74">2020-11-30T05:45:07.211Z</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Overall Health</span>:   <span style="color:#ae81ff">ok</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Subsystems</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Subsystem Name</span>:  <span style="color:#ae81ff">ServerRuntime</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Symptoms</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Node Name</span>:      <span style="color:#ae81ff">aks-pool1model-71528953-vmss000001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">managed-server2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">State</span>:          <span style="color:#ae81ff">RUNNING</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:   <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">SHUTDOWN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">managed-server3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:   <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">SHUTDOWN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">managed-server4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Cluster Name</span>:   <span style="color:#ae81ff">cluster-1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Desired State</span>:  <span style="color:#ae81ff">SHUTDOWN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Server Name</span>:    <span style="color:#ae81ff">managed-server5</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Start Time</span>:       <span style="color:#e6db74">2020-11-30T05:40:11.709Z</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Events</span>:             <span style="color:#ae81ff">&lt;none&gt;</span></span></span></code></pre></div>
  </div>
</details>
<h4 id="access-the-application">Access the application<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>Access the Administration Console using the admin load balancer IP address.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ADMIN_SERVER_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>kubectl -n sample-domain1-ns get svc sample-domain1-admin-server-external-lb -o<span style="color:#f92672">=</span>jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;Administration Console Address: http://</span><span style="color:#e6db74">${</span>ADMIN_SERVER_IP<span style="color:#e6db74">}</span><span style="color:#e6db74">:7001/console/&#34;</span></span></span></code></pre></div>
<p>Access the sample application using the cluster load balancer IP address.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">## Access the sample application using the cluster load balancer IP.</span>
</span></span><span style="display:flex;"><span>$ CLUSTER_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>kubectl -n sample-domain1-ns get svc sample-domain1-cluster-1-lb -o<span style="color:#f92672">=</span>jsonpath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span><span style="color:#66d9ef">)</span></span></span></code></pre></div>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl http://<span style="color:#e6db74">${</span>CLUSTER_IP<span style="color:#e6db74">}</span>:8001/myapp_war/index.jsp</span></span></code></pre></div>
<p>Successful output will look like:</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0"><code>&lt;html&gt;&lt;body&gt;&lt;pre&gt;
*****************************************************************

Hello World! This is version &#39;v1&#39; of the sample JSP web-app.

Welcome to WebLogic Server &#39;managed-server1&#39;!

  domain UID  = &#39;sample-domain1&#39;
  domain name = &#39;domain1&#39;

Found 1 local cluster runtime:
  Cluster &#39;cluster-1&#39;

Found min threads constraint runtime named &#39;SampleMinThreads&#39; with configured count: 1

Found max threads constraint runtime named &#39;SampleMaxThreads&#39; with configured count: 10

Found 0 local data sources:

*****************************************************************
&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></div>
<h3 id="rolling-updates">Rolling updates<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Naturally, you will want to deploy newer versions of the EAR application, located in the WDT archive ZIP file at <code>wlsdeploy/applications/myapp-v1</code>. To learn how to do this, follow the steps in 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/model-in-image/update3/"
   
   >
Update 3
</a>
.</p>
<h3 id="database-connection">Database connection<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>For guidance on how to connect a database to your AKS with WebLogic Server application, see 

<a href="https://learn.microsoft.com/en-us/azure/aks/howto-deploy-java-wls-app"
   
   
target="_blank" rel="noopener noreferrer"
>
Deploy a Java application with WebLogic Server on an Azure Kubernetes Service (AKS) cluster
</a>
.</p>
<h3 id="clean-up-resources">Clean up resources<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Run the following commands to clean up resources.</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ az group delete --yes --no-wait --name $AKS_PERS_RESOURCE_GROUP</span></span></code></pre></div>
<h3 id="troubleshooting">Troubleshooting<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>For troubleshooting advice, see 

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/"
   
   >
Troubleshooting
</a>
.</p>
<h3 id="useful-links">Useful links<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<ul>
<li>

<a href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/model-in-image/"
   
   >
Model in Image
</a>
 user documentation</li>
<li>

<a href="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/model-in-image/"
   
   >
Model in Image
</a>
 sample</li>
<li>

<a href="https://learn.microsoft.com/en-us/azure/aks/howto-deploy-java-wls-app"
   
   
target="_blank" rel="noopener noreferrer"
>
Deploy a Java application with WebLogic Server on an Azure Kubernetes Service (AKS) cluster
</a>
</li>
</ul>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">


<a id="logo" href="https://oracle.github.io/weblogic-kubernetes-operator/">
  <img src="https://oracle.github.io/weblogic-kubernetes-operator//images/logo.png" height="90"><br/>
  WebLogic Kubernetes Operator
</a>

        </div>
        <search><form action="https://oracle.github.io/weblogic-kubernetes-operator/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/quickstart/index.html"><b> </b>Quick Start</a><ul id="R-subsections-d63193e927818b6cb77d9c791ea48a61" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/introduction/index.html"><b> </b>Introduction</a><ul id="R-subsections-e1ed3a04f1f57a27be4a8d0eb274be18" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-operators/index.html"><b> </b>Manage operators</a><ul id="R-subsections-7d4cf64999b86ce8197c0bc43769472c" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/managing-domains/index.html">Manage domains</a><ul id="R-subsections-45a55625d0c34b621eb1935c75fae249" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/base-images/index.html"><b> </b>WebLogic images</a><ul id="R-subsections-b3440c9f2ce961fe2579290479f05e53" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/index.html"><b> </b>Samples</a><ul id="R-subsections-88c2b1e6419b221ce89c4be4a8ae2a6b" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/credentials/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/credentials/index.html">Credentials</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/storage/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/storage/index.html">Storage</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/database/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/database/index.html">Run a database</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/domains/index.html">Domains</a><ul id="R-subsections-fe6d3bc53518b5bcddc81ed793317942" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/rest/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/rest/index.html">REST APIs</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/ingress/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/ingress/index.html">Ingress</a></li>
            <li class="alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/elastic-stack/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/elastic-stack/index.html">Elastic Stack</a><ul id="R-subsections-3eee08beed8e21e290aa1f4316f1c391" class="collapsible-menu"></ul></li>
            <li class="parent alwaysopen " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/index.html">Azure Kubernetes Service</a><ul id="R-subsections-d57c7e28d3596876cc4763e66b41d50e" class="collapsible-menu">
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/domain-on-pv/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/domain-on-pv/index.html">Domain home on a PV</a></li>
            <li class="active " data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/model-in-image/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/model-in-image/index.html">Model in Image</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/azure-kubernetes-service/troubleshooting/index.html">Troubleshooting</a></li></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/samples/tanzu-kubernetes-service/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/samples/tanzu-kubernetes-service/index.html">Tanzu Kubernetes Service</a></li></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/developerguide/index.html"><b> </b>Developer Guide</a><ul id="R-subsections-6d5a8d333894e1a8a4ced31c7a69170c" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/reference/index.html"><b> </b>Reference</a><ul id="R-subsections-66002f201bef818664bb81aa67490c58" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/security/index.html"><b> </b>Security</a><ul id="R-subsections-66815ecaaecfc1c209e5637d03b258b2" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/faq/index.html">Frequently asked questions</a><ul id="R-subsections-24e4fc446616bf2bbeac7b1dba804bb8" class="collapsible-menu"></ul></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/deprecated-functionality/index.html">Deprecated functionality</a></li>
            <li class="" data-nav-url="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html"><a class="padding" href="https://oracle.github.io/weblogic-kubernetes-operator/known-limitations/index.html">Known limitations</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer">

<p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp</p>
<p><a href="https://github.com/oracle/weblogic-kubernetes-operator"><i class="fab fa-github"></i> GitHub repo</a></p>
<p><a href="https://join.slack.com/t/oracle-weblogic/shared_invite/zt-1ni1gtjv6-PGC6CQ4uIte3KBdm_67~aQ"><i class="fab fa-slack"></i> Public Slack #weblogic</a></p>
</div>
      </div>
    </aside>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/perfect-scrollbar/perfect-scrollbar.min.js?1769918999" defer></script>
    <script src="https://oracle.github.io/weblogic-kubernetes-operator/js/theme.min.js?1769918999" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
